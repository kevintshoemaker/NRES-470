<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 470/670" />


<title>Overview of population Viability Analysis</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Malthus (Limits to growth)</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation (Logistic growth)</a>
    </li>
    <li>
      <a href="LECTURE5.html">Positive density dependence (Allee effect)</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="LECTURE12.html">Overview of PVA</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Overview of population Viability
Analysis</h1>
<h4 class="author">NRES 470/670</h4>
<h4 class="date">Spring 2023</h4>

</div>


<p>R code for this lecture can be found <a href="LECTURE12.R">here</a>
### Final projects:</p>
<p>Just a heads up about <a href="FINAL_PROJECTS.html">final
projects</a>. Your working PVA and a document justifying your modeling
decisions is <em>due Wed, April 12</em>!</p>
<div id="population-viability-analysis-pva" class="section level2">
<h2>Population Viability Analysis (PVA)</h2>
<p>Population Viability Analysis (PVA) integrates everything we have
studied so far and more.</p>
<p>At its most basic level, PVA is the <em>process of building and
running a formal predictive population model for the purpose of gaining
insight about present and future conservation status, or ranking
alternative management options</em>.</p>
<p>PVA is used for assessing how stochasticity and inbreeding can lead
to extinction (small-population paradigm) and for assessing how to
reverse population declines (declining population paradigm).</p>
<p><strong>Q:</strong> Are PVA models always stochastic?</p>
<p><strong>Q:</strong> Are PVA models always density-dependent?</p>
<p><strong>Q:</strong> Are PVA models always age-structured?</p>
<p><strong>Q</strong>: Are PVA models always spatially-explicit?</p>
<div id="the-pva-process-recipe-for-pva" class="section level3">
<h3>The PVA process (recipe for PVA!)</h3>
<p><img src="PVAschematic1.png" /></p>
<p>The process of building a PVA model is
<strong>iterative</strong>.</p>
<p>For example – after running your model (step 4) and looking at your
results (step 5) you might realize that the model is totally
unrealistic. This might prompt you to go back and change your conceptual
model of the life history (step 1), and re-parameterize your model (step
2).</p>
<div id="step-1-conceptualize-life-history-processes"
class="section level4">
<h4>Step 1: Conceptualize life history processes</h4>
<p><a href="LECTURE3.html">Lecture 3</a>: exponential growth<br />
<a href="LECTURE4.html">Lecture 4</a>: density dependence<br />
<a href="LECTURE5.html">Lecture 5</a>: Allee effects<br />
<a href="LECTURE6.html">Lecture 6</a>: age structured populations<br />
<a href="LECTURE7.html">Lecture 7</a>: matrix population models<br />
<a href="LECTURE8.html">Lecture 8</a>: stochasticity<br />
(and labs 1,2,3,4,5)</p>
<p>The first step is to conceptualize the life history for your species
of interest. This is where you might put together a life history
diagram, and think about the following questions:</p>
<ul>
<li>How many life stages should I include?</li>
<li>Which life stages are reproductive?</li>
<li>Which vital rate(s) are density-dependent?</li>
<li>Does your species benefit from social aggregation? If so, are there
potential Allee effects?</li>
<li>Which vital rates vary from year to year (environmental
stochasticity)?</li>
<li>How might your proposed scenarios (e.g., management activities)
change key vital rates?</li>
<li>Are there any <em>catastrophes</em> that can affect the system?</li>
</ul>
<p><strong>Q</strong>: is there ever a case where you <em>WON’T</em>
include demographic stochasticity in your model?</p>
</div>
<div id="step-2-parameterize-the-demographic-model"
class="section level4">
<h4>Step 2: Parameterize the demographic model!</h4>
<p>Lecture 3: <a href="LECTURE3.html">exponential growth</a><br />
Lecture 4: <a href="LECTURE4.html">density dependence</a><br />
Lecture 5: <a href="LECTURE5.html">Allee effect</a> (if
applicable)<br />
Lecture 6+7: <a href="LECTURE6.html">age structure</a> and <a
href="LECTURE7.html">matrix population models</a><br />
Lecture 8: <a href="LECTURE8.html">stochasticity and
uncertainty</a><br />
(and Labs 1,2,3,4,5)</p>
<p>This is where you attach real numbers to the stocks and flows in your
conceptual life history diagram. Remember that these parameters are more
than just survival and fecundity. It’s also:</p>
<ul>
<li>Annual variation in survival and fecundity (environmental
stochasticity)<br />
</li>
<li>Initial abundances<br />
</li>
<li>Density dependence functions and parameters (including K)<br />
</li>
<li>Allee threshold (if applicable)<br />
</li>
<li>Catastrophe effect sizes and probabilities<br />
</li>
<li>Effects of management actions<br />
</li>
<li>And more…</li>
</ul>
<p>[stone soup analogy to model parameterization!]</p>
</div>
<div id="step-3-spatial-structure" class="section level4">
<h4>Step 3: Spatial structure!</h4>
<p>Most of your projects will probably not include spatial structure.
This is the topic for lectures in the next couple weeks (and lab 6)!</p>
<p><a href="LECTURE13.html">Lecture 13</a>: metapopulation models<br />
<a href="LECTURE14.html">Lecture 14</a>: source-sink dynamics<br />
<a href="LAB6.html">Lab 6</a>: metapopulation models</p>
<p>If you want to ask spatial questions, your model needs to be
spatially explicit, or at least consider spatial structure in some way.
The kinds of questions you might think about include:</p>
<ul>
<li>How many discrete populations are there in your
metapopulation?<br />
</li>
<li>Do different populations have different mean vital rates? Are some
populations likely to be sources and others likely to be sinks?<br />
</li>
<li>Is environmental stochasticity <strong>spatially
correlated</strong>? (is a bad year in one subpopulation likely to be a
bad year in every subpopulation?)</li>
<li>At what rate do individuals move among these populations?</li>
<li>Can connectivity be enhanced via habitat management?</li>
<li>Are dispersal rates density-dependent?</li>
</ul>
</div>
<div id="step-4-simulate" class="section level4">
<h4>Step 4: Simulate!</h4>
<p><a href="LECTURE1.html">Lecture 1</a>: systems thinking<br />
<a href="LECTURE2.html">Lecture 2</a>: feedbacks</p>
<p>(In-class InsightMaker exercises, all labs)</p>
<p>You all know how to simulate populations now!</p>
<p>Be creative and use common sense- set up the simulations so that they
can help you answer your key research questions!</p>
<ul>
<li>What scenarios do you want to test?</li>
<li>How many replicates are sufficient?</li>
<li>What simulation results do you need to record for making plots and
running analyses?</li>
</ul>
</div>
<div id="step-5-results" class="section level4">
<h4>Step 5: Results</h4>
<p>I recommend using R or Excel to analyze your results and make plots
to illustrate the results of your scenario tests.</p>
<p>InsightMaker plots (abundance over time) are great (and can be
included in presentations and reports). However, this is often not the
best way to visualize and summarize key differences among your
simulation scenarios!</p>
<p>Overall, you need to make sense of all the simulations you just ran
and present your results in ways that make sense to your readers!</p>
<p>There are two types of data analysis tools that you will need to be
able to use the simulation results to answer your questions:
<strong>graphical visualization</strong> and <strong>statistical
analysis</strong>.</p>
<p>These tools- visualization and statistical analysis - are diverse,
and there is no one-size-fits-all way that you should visualize and
analyze your simulation results. It really depends on your question!! I
will give you some ideas here about graphical representations in the
demo PVA below - but just remember you are not limited to these ideas-
be creative!</p>
<p>Since this class is not a statistics class, I don’t necessarily
expect you to do sophisticated stats as part of your project- but your
TAs and I can work with your groups individually to figure out some
simple statistical analyses that make sense for your project. Learning
to use statistics will definitely come in handy in the future!</p>
</div>
</div>
</div>
<div id="a-simple-demonstration-pva" class="section level2">
<h2>A Simple Demonstration PVA</h2>
<p>To illustrate some of these concepts, let’s build and run a simple
PVA in R. If you want to follow along, click <a
href="LECTURE12.R">here</a></p>
<div id="step-1-conceptualize-the-life-history" class="section level3">
<h3>Step 1: conceptualize the life history</h3>
<p>For simplicity, let’s ignore age structure for now - this is just a
simple stochastic, one-stage (scalar) population model!</p>
<p>Also let’s ignore parameter uncertainty too!</p>
</div>
<div id="step-2-parameterize" class="section level3">
<h3>Step 2: parameterize!</h3>
<p>Here is the basic model parameterization:</p>
<pre class="r"><code># Demonstration PVA ---------------------------------

# STEP 1: conceptualize life history (we are modeling this population as a simple, single-stage stochastic model with density dependence)

# STEP 2: parameterize the model ---------------------------------

# Basic life history parameters

R_max &lt;- 1.15       # Maximum rate of growth
Init_N &lt;- 51        # Initial abundance (not stage structured)
K &lt;- 175            # Carrying capacity

# Environmental stochasticity ------------------------------------

SD_anngrowth &lt;- 0.11  # standard deviation of annual growth rate

# Density-dependence (Ricker model) ----------------------------------

Ricker &lt;- function(prev_abund){       # this is a function for computing next-year abundance -- includes env stochasticity
  prev_abund * exp(log(rnorm(1,R_max,SD_anngrowth))*(1-(prev_abund/K)))
}

# Catastrophe -------------------------

Flood_prob &lt;- 0.05      # 5% chance of major flood
Flood_lambda &lt;- 0.25    # 25% of population can survive a flood </code></pre>
</div>
<div id="step-3-spatial-structure-1" class="section level3">
<h3>Step 3: spatial structure</h3>
<p>Let’s ignore spatial structure! We will learn more about modeling
spatial structure in the next two lectures!</p>
</div>
<div id="step-4-simulate-1" class="section level3">
<h3>Step 4: simulate!</h3>
<p>Now we can use these parameters to build and run a simple PVA
model:</p>
<pre class="r"><code># STEP 3: add spatial structure (not applicable here)

# STEP 4: simulate!  -------------------------------

# Basic simulation parameters

nyears &lt;- 100     # number of years
nreps &lt;- 500      # number of replicates


PVAdemo &lt;- function(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda){
  #browser()
  PopArray2 &lt;- array(0,dim=c((nyears+1),nreps))   # set up storage array
  
  ## start looping through replicates
  
  for(rep in 1:nreps){
    
    # set initial abundance
    PopArray2[1,rep] &lt;- Init_N     # set the initial abundance
    
    ### loop through years
    for(y in 2:(nyears+1)){
      ### stochasticity and d-d
      nextyear &lt;- max(0,trunc(Ricker(PopArray2[y-1,rep])))
      
      ### catastrophe
      if(runif(1)&lt;Flood_prob) nextyear &lt;- nextyear*Flood_lambda
      PopArray2[y,rep] &lt;- nextyear 
    }
  }
  
  return(PopArray2)
}

### Run the PVA! -------------------

Default &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda)</code></pre>
</div>
<div id="step-5-results-1" class="section level3">
<h3>Step 5: results!</h3>
<p>Now we can perform graphical visualizations and statistics that
answer our original questions!</p>
<div id="graphical-visualization" class="section level4">
<h4>Graphical visualization</h4>
<p>There are several types of visualizations that you might want to use
for your PVA models:</p>
<p>The first is to look at the “cloud” of abundance trajectories. This
is the same type of figure we have seen in InsightMaker using the
“Sensitivity testing” tool.</p>
<pre class="r"><code># STEP 5: results  ------------------------- 

# Graphical visualization

PlotCloud &lt;- function(simdata){
  plot(c(1:101),simdata[,1],col=gray(0.7),type=&quot;l&quot;,ylim=c(0,max(simdata)),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;)
  
  for(r in 2:ncol(simdata)){
    lines(c(1:101),simdata[,r],col=gray(0.7),type=&quot;l&quot;)
  }
}

PlotCloud(Default)</code></pre>
<p><img src="LECTURE12_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Okay, what do we learn from this?</p>
<p>If our question is about extinction risk, maybe we want to plot
extinction risk by time…</p>
<pre class="r"><code># Visualize extinction rates over time

Extinction_byyear &lt;- function(simdata){
  apply(simdata,1,function(t)  length(which(t==0)))/ncol(simdata)
}

plot(c(1:101),Extinction_byyear(Default),type=&quot;l&quot;,lwd=2,xlab=&quot;year&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="LECTURE12_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Maybe our question is about the probability of decline over 100 years
…</p>
<p>In that case maybe we should present a histogram of final
abundances…</p>
<pre class="r"><code># visualize final abundance after 100 years relative to initial abundance

hist(Default[nrow(Default),],xlab=&quot;Final abundance after 100 years&quot;,ylab=&quot;Number of replicates&quot;,main=&quot;&quot;)
abline(v=Init_N,col=&quot;green&quot;,lwd=2)</code></pre>
<p><img src="LECTURE12_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Or we could plot the extent of decline vs the probability of falling
below that threshold at year 100.</p>
<pre class="r"><code># plot probabilities of different severities of decline

declines &lt;- seq(0,100,by=1)
declineprob &lt;- numeric(length(declines))

for(s in 1:length(declines)){
  declineprob[s] &lt;- length(which(Default[nrow(Default),]&lt;(Init_N-(declines[s]/100)*Init_N)))/ncol(Default)
}

plot(declines,declineprob,type=&quot;l&quot;,lwd=2,xlab=&quot;Decline threshold (percent)&quot;,ylab=&quot;Probability of falling below threshold&quot;)

abline(v=25,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="LECTURE12_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>What if our question is about the effect of flooding on extinction
risk. Let’s imagine that the probability of flooding is not expected to
change with climate change, but that the intensity of the flood damage
is likely to increase substantially!</p>
<p>Currently, floods generally result in a 25% population reduction. But
climate change could increase this number to as much as 90%. Let’s look
at how much this could increase extinction risk!</p>
<pre class="r"><code># Plot extinction risk as a function of flood severity

Exctinction_risk &lt;- function(simdata){
  length(which(simdata[nrow(simdata),]==0))/ncol(simdata)
}

flood_lambdas &lt;- seq(0.9,0.1,by=-0.05)

all_scenarios &lt;- numeric(length(flood_lambdas))
for(scenario in 1:length(flood_lambdas)){
  PVA &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,flood_lambdas[scenario])
  all_scenarios[scenario] &lt;- Exctinction_risk(PVA)
}

plot(1-flood_lambdas,all_scenarios,type=&quot;p&quot;,cex=2,xlab=&quot;flood impact (mortality in flood year)&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="LECTURE12_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
