<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 470/670" />


<title>Species interactions: prey-predator!</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Malthus (Limits to growth)</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation (Logistic growth)</a>
    </li>
    <li>
      <a href="LECTURE5.html">Positive density dependence (Allee effect)</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="LECTURE12.html">Overview of PVA</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Species interactions: prey-predator!</h1>
<h4 class="author">NRES 470/670</h4>
<h4 class="date">Spring 2023</h4>

</div>


<div id="predation" class="section level2">
<h2>Predation</h2>
<p><img src="predation1.jpg" /></p>
<p><img src="predation2.jpg" /></p>
<p>In the case of competition, we saw that each species negatively
influenced the other. In the case of prey-predator interactions, one of
the two actors benefits greatly from the interaction – and the other
actor loses out!</p>
<p>Nearly all prey-predator models, even the most state-of-the-art,
complex ones, share this common framework:</p>
<p><span class="math inline">\(\Delta V = rV^* - f(V) \cdot
P\)</span></p>
<p>AND</p>
<p><span class="math inline">\(\Delta P = f(V)*conversion\space factor
\cdot P - qP^*\)</span></p>
<p>Where</p>
<p><span class="math inline">\(V\)</span> is the total prey abundance (V
for victims!), and</p>
<p><span class="math inline">\(P\)</span> is the total predator
abundance, and</p>
<p><span class="math inline">\(rV^*\)</span> represents the growth of
the prey population <em>in the absence of predators</em> – usually, this
is some form of the standard single-species population growth models we
have considered throughout most of this course (possibly
density-dependent),</p>
<p><span class="math inline">\(-qP^*\)</span> represents the growth of
the predator population <em>in the absence of prey</em> – usually this
is simply exponential decline!,</p>
<p>AND</p>
<p><span class="math inline">\(f(V)\)</span> is known as the
<strong>functional response</strong> – that is, the per-capita rate of
prey consumption, usually a function of just the density (availability)
of prey, but sometimes a function of both predator and prey densities
(<span class="math inline">\(f(V,P)\)</span>).</p>
<p>AND</p>
<p><span class="math inline">\(f(V)\cdot conversion\space
factor\)</span> (alternatively represented as <span
class="math inline">\(g(V)\)</span>) is known as the <strong>numerical
response</strong> – that is, the increase in per-capita predator
population growth due to prey consumption.</p>
<p>There are many different types of possible functional and numerical
response curves. Let’s start simple!</p>
<div id="the-classical-prey-predator-model" class="section level3">
<h3>The classical prey-predator model</h3>
<p>Let’s look at predation mathematically, starting with the simplest
possible model…</p>
<div id="the-victims" class="section level4">
<h4>The victims…</h4>
<p>We will consider the prey, or “victims” first:</p>
<p>In the absence of predators, let’s assume that the victim population
grows according to the basic exponential growth equation:</p>
<p><span class="math inline">\(\Delta V = rV\)</span></p>
<p>We will assume that the intrinsic rate of growth, <span
class="math inline">\(r\)</span>, is positive! In the absence of
predators, the population grows exponentially.</p>
<p>If predators are present, the population growth of the victims will
slow down…</p>
<p>What expression could define the rate at which prey are consumed by
predators?</p>
<p>First of all, let’s assume that predators and prey walk randomly
through their common environment, bumping into each other randomly.
Every time the predator bumps into a prey item, the predator has some
chance of consuming that prey item.</p>
<p>This is analogous to molecules moving randomly in a solution,
occasionally causing reactions whenever they bump into other molecule(s)
in the right way.</p>
<p>Under such circumstances, the predators do NOT interfere with one
another and never get full. Each predator consumes a fixed number of
prey in a given time period, depending only on prey availability.</p>
<p>Consider the case where there are <span
class="math inline">\(V\)</span> prey and only a single predator in a
hypothetical prey-predator system.</p>
<p><strong>Q</strong>: Imagine there are 100 prey and only one predator.
A total of 3 prey are consumed in a single day. What is the daily rate
of prey consumption per predator in this example (<span
class="math inline">\(\alpha\)</span>)?</p>
<p>In this case, 3% (0.03) of prey are successfully encountered and
consumed by the predator each day. If there were 1000 prey on the
landscape, the predator would catch and consume 30 prey. And if there
were 1 million prey, the predator would catch and consume 30,000 prey
per day. (realistic?)</p>
<p><strong>Q</strong> what is the shape of the functional response in
this case?</p>
<p><span class="math inline">\(f(V)=\alpha \cdot V\)</span></p>
<pre class="r"><code># simple functional response

LVfuncresp &lt;- function(V,alpha){
  alpha*V
}

curve(LVfuncresp(x,0.03),0,200,xlab=&quot;Victim abundance&quot;,ylab=&quot;Total prey eaten per predator&quot;,col=&quot;red&quot;,lwd=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>…Of course, this <em>alpha</em> term has a different meaning from the
<em>alpha</em> in the L-V competition models! Sorry but you can thank
Alfred Lotka for that!</p>
<p>Now consider the case where there is more than one predator – that
is, there are <span class="math inline">\(P\)</span> predators and there
are <span class="math inline">\(V\)</span> prey. Recall that each
predator has <em>no influence</em> on the consumption rates of other
predators. The predators are just like molecules randomly bumping into
prey molecules.</p>
<p>The <em>total rate of predation</em> now is:</p>
<p><span class="math inline">\(f(V) \cdot P = \alpha VP\)</span></p>
<p>Does this make sense?</p>
<p>The term <span class="math inline">\(\alpha\)</span> is sometimes
referred to as <strong>capture efficiency</strong>. Does this make
sense?</p>
<p>Now, the (instantaneous) prey growth rate can be defined by the
following equation:</p>
<p><span class="math inline">\(\Delta V = rV - \alpha VP\)</span></p>
<p>In the absence of predators, the prey population grows exponentially.
However, with enough predators on the landscape, the population will
decline.</p>
<p>This model is one half of what is known as the
<strong>Lotka-Volterra</strong> prey-predator model.</p>
<p>The other half is the predator population growth model, of
course!!</p>
</div>
<div id="the-predators" class="section level4">
<h4>The predators…</h4>
<p>In the absence of prey, let’s assume that the predator population
grows just how we might imagine it grows- BADLY!</p>
<p>In the absence of prey, the predator population declines
exponentially.</p>
<p><span class="math inline">\(\Delta P = -qP\)</span></p>
<p>If enough prey are present, the population growth rate of the
predators will go up…</p>
<p>Recall that (in this simple model) predators and prey walk randomly
through their common environment, bumping into each other randomly. Each
predator consumes a fixed percentage of the prey population. That is,
the functional response is:</p>
<p><span class="math inline">\(f(V) = \alpha V\)</span></p>
<p>The <em>numerical response</em> is the increase in the fractional
growth rate of <em>predators</em> per unit prey consumed. The numerical
response is related to the functional response. While the functional
response describes the prey consumption rate per predator, the numerical
response describes how that prey consumption translates into the growth
of the predator population.</p>
<p><span class="math inline">\(g(V) = some.function(f(V))\)</span></p>
<p>The simplest numerical response is that predator population growth
increases as a linear function of per-capita prey consumption:</p>
<p><span class="math inline">\(g(V) = \gamma (\alpha \cdot
V)\)</span></p>
<p>Where <span class="math inline">\(\gamma\)</span> is sometimes
referred to as ‘conversion efficiency’ and <span
class="math inline">\(\alpha\)</span> is the capture efficiency and
<span class="math inline">\(\alpha \cdot V\)</span> is the total prey
consumed per predator.</p>
<p>Or, since two constants multiplied together results in another
constant:</p>
<p><span class="math inline">\(g(V)=\beta \cdot V\)</span></p>
<p><strong>Q</strong> what is the shape of the <strong>numerical
response</strong> in this case?</p>
<pre class="r"><code># Numerical response

LVnumresp &lt;- function(V,beta){
  beta*V
}

curve(LVnumresp(x,0.001),0,200,xlab=&quot;Victim abundance&quot;,ylab=&quot;Increase in r for predator population&quot;,col=&quot;blue&quot;,lwd=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>The <em>increase in total predators due to prey consumption</em> now
is:</p>
<p><span class="math inline">\(g(V) \cdot P = \beta \cdot V \cdot
P\)</span></p>
<p>Does this make sense?</p>
<p>Now, the (instantaneous) PREDATOR growth rate can be defined by the
following equation:</p>
<p><span class="math inline">\(\Delta P = \beta VP - qP\)</span></p>
<p>This model is the other half of what is known as the
<strong>Lotka-Volterra</strong> prey-predator model.</p>
<p>Taken together, the model can be described as follows:</p>
<p><span class="math inline">\(\Delta P = \beta VP - qP\)</span></p>
<p><span class="math inline">\(\Delta V = rV - \alpha VP\)</span></p>
</div>
</div>
<div id="l-v-predation-model-in-insightmaker" class="section level3">
<h3>L-V predation model in InsightMaker</h3>
<p>Before we go deeper into predation modeling, let’s simulate prey and
predator population growth under the L-V predation model.</p>
<p><strong>Step 1</strong>: First, clone <a
href="https://insightmaker.com/insight/5rui2efFmW8cBmVDyxPw5h/Base-prey-predator-model">this
Insight</a>, which provides the skeleton for a basic prey-predator
model</p>
<p><strong>Step 2</strong>: Correctly set up the equations for the
variables “functional response”” and “numerical response”.</p>
<p><strong>Step 3</strong>: Correctly set up the flow equations for
“total prey consumed” and “predator growth”, which refer to the the prey
lost and the predators gained per time step, respectively.</p>
<p><strong>Step 4</strong>: In the settings menu, change the simulation
length to 200 and make sure that your analysis algorithm is set to
“Accurate (RK4)” (this makes InsightMaker behave more like a continuous
growth model).</p>
<p><strong>Step 5</strong>: Set the Initial abundance of prey and
predators to 100 and 50, respectively. Set the alpha and beta terms to
0.001, and set the r_prey and q_pred terms to 0.1. Run the model and
visualize the time series for prey and predators.</p>
<p><strong>Q</strong> What happens if you change the initial
abundances?</p>
<p><strong>Q</strong> What happens if you change initial abundance of
both species to 100? Is this an <strong>equilibrium</strong>? If so, is
it <strong>stable</strong>?</p>
<p><strong>Step 6</strong>: Try some other parameter values for alpha,
beta, r, and q…</p>
<p><strong>Q</strong> Does the prey or predator ever go extinct?</p>
<p><strong>Q</strong> Can you find some settings that make very slow
oscillations?</p>
<p><strong>Q</strong> Can you find some settings that make very fast
oscillations?</p>
<p><strong>Q</strong> Can you find some settings that make very shallow
oscillations?</p>
</div>
</div>
<div id="prey-predator-models-on-the-phase-plane"
class="section level2">
<h2>Prey-Predator models on the phase plane!</h2>
<p>If you want to follow along in R, click <a
href="LECTURE17.R">here</a> for the R script!</p>
<pre class="r"><code># LOTKA VOLTERRA PREDATION EXAMPLE (on phase plane)

## Params

Alpha &lt;- 0.001
Beta &lt;- 0.001
InitPrey &lt;- 100
InitPred &lt;- 75
r &lt;- 0.1
q &lt;- 0.1
Nyears &lt;- 100
step &lt;- 0.1

System &lt;- data.frame(prey = rep(InitPrey,(Nyears+1)*10),pred = InitPred)

doYear &lt;- function(prevyear){
  n1 &lt;- prevyear[1] + r*prevyear[1]*step - Alpha*prevyear[1]*prevyear[2]*step
  n2 &lt;- prevyear[2] + Beta*prevyear[1]*prevyear[2]*step - q*prevyear[2]*step 
  return(c(n1,n2))
}

## Do simulation
for(i in 1:(Nyears*10+1)){
  System[1+i,] &lt;- doYear(System[i,])
}</code></pre>
<p>Now let’s visualize this basic L-V system in <em>phase
space</em>:</p>
<pre class="r"><code>plot(1,1,pch=&quot;&quot;,ylim=c(0,200),xlim=c(0,200),xlab=&quot;prey&quot;,ylab=&quot;predators&quot;)
points(System[seq(1,1000,10),],col=&quot;green&quot;,type=&quot;p&quot;,pch=20,cex=0.85)
points(System[1,],col=&quot;blue&quot;,pch=20,cex=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Okay, so as prey get more abundant, predators start increasing, but
as predators increase, prey abundance goes down. And repeat!</p>
<p>Here is another example…</p>
<pre class="r"><code># LOTKA VOLTERRA PREDATION EXAMPLE

## Params

Alpha &lt;- 0.005
Beta &lt;- 0.005
InitPrey &lt;- 100
InitPred &lt;- 75
r &lt;- 0.2
q &lt;- 0.1
Nyears &lt;- 100
step &lt;- 0.1

System &lt;- data.frame(prey = rep(InitPrey,(Nyears+1)*10),pred = InitPred)

doYear &lt;- function(prevyear){
  n1 &lt;- prevyear[1] + r*prevyear[1]*step - Alpha*prevyear[1]*prevyear[2]*step
  n2 &lt;- prevyear[2] + Beta*prevyear[1]*prevyear[2]*step - q*prevyear[2]*step 
  return(c(n1,n2))
}

## Do simulation
for(i in 1:(Nyears*10+1)){
  System[1+i,] &lt;- doYear(System[i,])
}


plot(1,1,pch=&quot;&quot;,ylim=c(0,200),xlim=c(0,200),xlab=&quot;prey&quot;,ylab=&quot;predators&quot;)
points(System[seq(1,1000,10),],col=&quot;green&quot;,type=&quot;p&quot;,pch=20,cex=0.85)
points(System[1,],col=&quot;blue&quot;,pch=20,cex=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>With some jittering, we can visualize the amount of time the system
spends in various parts of phase space…</p>
<pre class="r"><code>plot(1,1,pch=&quot;&quot;,ylim=c(0,200),xlim=c(0,200),xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
points(jitter(System[,1],200),jitter(System[,2],200),col=&quot;brown&quot;,pch=20,cex=0.3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code>#abline(h=K2,v=K1,col=&quot;gray&quot;,lwd=2,lty=2)</code></pre>
<p>You can see that this system spends much more time near the origin,
where abundances are low for both prey and predator!</p>
<p>Finally, let’s consider multiple starting points and see how the
system behaves!</p>
<pre class="r"><code>## LOTKA VOLTERRA PREDATION EXAMPLE

## Params


InitN1 &lt;- 120
InitN2 &lt;- 25
System1 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System1[1+i,] &lt;- doYear(System1[i,])
}

InitN1 &lt;- 200
InitN2 &lt;- 100
System2 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System2[1+i,] &lt;- doYear(System2[i,])
}


InitN1 &lt;- 50
InitN2 &lt;- 200
System3 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System3[1+i,] &lt;- doYear(System3[i,])
}</code></pre>
<p>Now, phase space looks like this (with jittering to indicate
concentration of points:</p>
<pre class="r"><code>plot(1,1,pch=&quot;&quot;,ylim=c(0,400),xlim=c(0,400),xlab=&quot;species 1&quot;,ylab=&quot;species 2&quot;)
points(jitter(System[,1],500),jitter(System[,2],500),col=&quot;brown&quot;,pch=20,cex=0.3)
points(jitter(System1[,1],500),jitter(System1[,2],500),col=&quot;green&quot;,pch=20,cex=0.3)
points(jitter(System2[,1],500),jitter(System2[,2],500),col=&quot;red&quot;,pch=20,cex=0.3)
points(jitter(System3[,1],500),jitter(System3[,2],500),col=&quot;blue&quot;,pch=20,cex=0.3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>#abline(h=K2,v=K1,col=&quot;gray&quot;,lwd=2,lty=2)</code></pre>
<p><strong>Q</strong>: Does this predator-prey system have a stable
equilibrium?</p>
<p><strong>Q</strong>: Does this predator-prey system have an
equilibrium at all?</p>
<p><strong>Q</strong>: How do these dynamics look like when visualized
as time series?</p>
<pre class="r"><code>plot(seq(1,100,length=nrow(System)), System[,1], xlab=&quot;Time&quot;, ylab=&quot;Abundance&quot;,type=&quot;l&quot;,col=&quot;orange&quot;,lwd=2,ylim=c(0,160),xlim=c(0,95))
points(seq(1,100,length=nrow(System)), System[,2], xlab=&quot;Time&quot;, ylab=&quot;Abundance&quot;,type=&quot;l&quot;,col=&quot;green&quot;,lwd=2,lty=2)
legend(&quot;top&quot;,lwd=c(2,2),lty=c(1,2),col=c(&quot;orange&quot;,&quot;green&quot;),legend=c(&quot;prey&quot;,&quot;predator&quot;),bty=&quot;n&quot;)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<div id="more-with-the-l-v-predator-prey-phase-space"
class="section level3">
<h3>More with the L-V predator-prey phase space!</h3>
<p>Just like before, let’s draw arrows throughout phase space,
representing where the system would be expected to go from each point in
phase space.</p>
<pre class="r"><code>## SPECIFY MODEL AND INITIALIZE
#
## toggle switch function for phase arrow and nullcline plotting 

toggle = compiler::cmpfun(function(u,v,parms) {
  c( u*parms[1]-parms[2]*u*v, parms[3]*u*v-parms[4]*v )
})

fun=toggle ## Our generic name for the system of equations to look at! ;-)
#
## toggle switch function for computing solution trajectories with deSolve::ode()

#Toggle = as.ode.func(toggle)
#
## parameter values?

Alpha &lt;- 0.005
Beta &lt;- 0.005
r &lt;- 0.2
q &lt;- 0.1

parms=c(r,Alpha,Beta,q)

# toggle(100,100,parms)

xlim = c(5,200)
ylim = c(5,200)
new &lt;- phasearrows.calc(toggle,xlim,ylim,resol=25,parms=parms)

plot(1,1,pch=&quot;&quot;,xlim=xlim,ylim=ylim,xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
phasearrows.draw(new)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>#
## END MODEL SPECIFICATION AND INITIALIZATION
#######################################################################################</code></pre>
<p>Are there any other possible outcomes of this simple L-V model?</p>
<p>Well, let’s plot out the isoclines then!!</p>
</div>
<div id="isoclines" class="section level3">
<h3>Isoclines!</h3>
<p>Again, it can be helpful to plot out the isoclines in phase space –
that is, the conditions under which the predator and prey populations do
NOT grow!</p>
<p>If we set the L-V prey growth equation to zero, we find that the
victim population is stable under the following conditions in phase
space:</p>
<p><span class="math inline">\(\hat{P} =\frac{r}{\alpha}\)</span></p>
<p>If we set the L-V predator equation to zero, we find that the
predator population is stable under the following conditions in phase
space:</p>
<p><span class="math inline">\(\hat{V} =\frac{q}{\beta}\)</span></p>
<p>That is, the prey population is stable only if there are just enough
predators to bump into (and subsequently eat up) any excess individuals
produced each year</p>
<p>And the predator population is stable only if there are just enough
prey to offset natural mortality.</p>
<p>Let’s visualize this in phase space.</p>
<pre class="r"><code>plot(1,1,pch=&quot;&quot;,xlim=xlim,ylim=ylim,xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
phasearrows.draw(new)
abline(h=r/Alpha,col=&quot;red&quot;,lwd=3)   # prey
abline(v=q/Beta,col=&quot;blue&quot;,lwd=3)   # pred</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
</div>
<div id="assumptions-of-the-l-v-prey-predator-model"
class="section level2">
<h2>Assumptions of the L-V prey-predator model</h2>
<ul>
<li>Victim population is regulated only by predation</li>
<li>Predator feeds only on one species of prey</li>
<li>Individual predators can consume infinity prey items per time step
theoretically</li>
<li>No interference among predators</li>
<li>Victims have no refuge from predators</li>
</ul>
</div>
<div id="more-realistic-prey-predator-models" class="section level2">
<h2>More realistic prey-predator models</h2>
<p>Let’s see what happens if we relax some of these assumptions!</p>
<ul>
<li>give the prey a carrying capacity!</li>
<li>modify the functional response!</li>
<li>add a refuge for prey!</li>
<li>add a predator carrying capacity!</li>
</ul>
<p>We can play around with these scenarios in InsightMaker. But it can
be instructive to visualize in phase space first. For example, let’s
incorporate a victim carrying capacity.</p>
<div id="victim-k-in-phase-space" class="section level3">
<h3>victim K in phase space</h3>
<pre class="r"><code>## SPECIFY MODEL AND INITIALIZE
#
## toggle switch function for phase arrow and nullcline plotting 

toggle = compiler::cmpfun(function(u,v,parms) {
  c( u*parms[1]-parms[2]*u*v - parms[3]*u^2, parms[4]*u*v-parms[5]*v )
})

fun=toggle ## Our generic name for the system of equations to look at! ;-)
#
## toggle switch function for computing solution trajectories with deSolve::ode()

#Toggle = as.ode.func(toggle)
#
## parameter values?

Alpha &lt;- 0.001
Beta &lt;- 0.005
r &lt;- 0.2
q &lt;- 0.1
c &lt;- 0.008

parms=c(r,Alpha,c,Beta,q)

# toggle(100,100,parms)

xlim = c(5,200)
ylim = c(5,200)
new &lt;- phasearrows.calc(toggle,xlim,ylim,resol=25,parms=parms)

plot(1,1,pch=&quot;&quot;,xlim=xlim,ylim=ylim,xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
phasearrows.draw(new)</code></pre>
<pre><code>## Warning in arrows(c(x), c(y), c(x + dx * z1/((lens2) + 0.1)), c(y + dx * : zero-
## length arrow is of indeterminate angle and so skipped</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>#
## END MODEL SPECIFICATION AND INITIALIZATION
#######################################################################################</code></pre>
<p>Adding isoclines, it looks something like this:</p>
<pre class="r"><code>plot(1,1,pch=&quot;&quot;,xlim=xlim,ylim=ylim,xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
phasearrows.draw(new)</code></pre>
<pre><code>## Warning in arrows(c(x), c(y), c(x + dx * z1/((lens2) + 0.1)), c(y + dx * : zero-
## length arrow is of indeterminate angle and so skipped</code></pre>
<pre class="r"><code>abline((r/Alpha),-(c/Alpha),col=&quot;red&quot;,lwd=3)   # prey
abline(v=q/Beta,col=&quot;blue&quot;,lwd=3)   # pred</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Follow the arrows. What do you think the system dynamics will look
like?</p>
<pre class="r"><code>## Params

Alpha &lt;- 0.001
Beta &lt;- 0.005
r &lt;- 0.2
q &lt;- 0.1
c &lt;- 0.008
InitPrey &lt;- 100
InitPred &lt;- 75
Nyears &lt;- 100
step &lt;- 0.1

System &lt;- data.frame(prey = rep(InitPrey,(Nyears+1)*10),pred = InitPred)

doYear &lt;- function(prevyear){
  n1 &lt;- prevyear[1] + r*prevyear[1]*step - Alpha*prevyear[1]*prevyear[2]*step - c*prevyear[1]^2*step
  n2 &lt;- prevyear[2] + Beta*prevyear[1]*prevyear[2]*step - q*prevyear[2]*step 
  return(c(n1,n2))
}

## Do simulation
for(i in 1:(Nyears*10+1)){
  System[1+i,] &lt;- doYear(System[i,])
}

##### LOTKA VOLTERRA PREDATION EXAMPLE

## Params


InitN1 &lt;- 100
InitN2 &lt;- 200
System1 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System1[1+i,] &lt;- doYear(System1[i,])
}

InitN1 &lt;- 100
InitN2 &lt;- 100
System2 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System2[1+i,] &lt;- doYear(System2[i,])
}


InitN1 &lt;- 50
InitN2 &lt;- 20
System3 &lt;- data.frame(n1 = rep(InitN1,(Nyears*10+1)),n2 = InitN2)
## Do simulation
for(i in 1:(Nyears*10+1)){
  System3[1+i,] &lt;- doYear(System3[i,])
}

plot(1,1,pch=&quot;&quot;,xlim=xlim,ylim=ylim,xlab=&quot;Prey&quot;,ylab=&quot;Predators&quot;)
phasearrows.draw(new)</code></pre>
<pre><code>## Warning in arrows(c(x), c(y), c(x + dx * z1/((lens2) + 0.1)), c(y + dx * : zero-
## length arrow is of indeterminate angle and so skipped</code></pre>
<pre class="r"><code>abline((r/Alpha),-(c/Alpha),col=&quot;red&quot;,lwd=3)   # prey
abline(v=q/Beta,col=&quot;blue&quot;,lwd=3)   # pred
points(jitter(System[,1],500),jitter(System[,2],500),col=&quot;brown&quot;,pch=20,cex=0.3)
points(jitter(System1[,1],500),jitter(System1[,2],500),col=&quot;green&quot;,pch=20,cex=0.3)
points(jitter(System2[,1],500),jitter(System2[,2],500),col=&quot;red&quot;,pch=20,cex=0.3)
points(jitter(System3[,1],500),jitter(System3[,2],500),col=&quot;blue&quot;,pch=20,cex=0.3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Now, does the system have a stable equilibrium???</p>
<p>Let’s visualize as a time series!</p>
<pre class="r"><code>plot(seq(1,100,length=nrow(System)), System[,1], xlab=&quot;Time&quot;, ylab=&quot;Abundance&quot;,type=&quot;l&quot;,col=&quot;orange&quot;,lwd=2,ylim=c(0,160),xlim=c(0,95))
points(seq(1,100,length=nrow(System)), System[,2], xlab=&quot;Time&quot;, ylab=&quot;Abundance&quot;,type=&quot;l&quot;,col=&quot;green&quot;,lwd=2,lty=2)
legend(&quot;top&quot;,lwd=c(2,2),lty=c(1,2),col=c(&quot;orange&quot;,&quot;green&quot;),legend=c(&quot;prey&quot;,&quot;predator&quot;),bty=&quot;n&quot;)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="alternative-functional-responses" class="section level3">
<h3>Alternative functional responses</h3>
<p>The L-V prey-predator model assumes that prey consumption per
predator increases linearly with an increase in prey abundance.
Following C.S. “Buzz” Holling, this is known as a <strong>“Type I”
functional response</strong>.</p>
<p>The Type I functional response makes several unrealistic assumptions
– for example, that predators never get full and stop eating!</p>
<p>As we have seen before, the type I functional response looks
something like this!</p>
<p><span class="math inline">\(f(V)=\alpha \cdot V\)</span></p>
<pre class="r"><code>TypeIfuncresp &lt;- function(V,alpha){
  alpha*V
}

curve(TypeIfuncresp(x,0.1),0,500,xlab=&quot;Victim abundance&quot;,ylab=&quot;Total prey eaten per predator&quot;,col=&quot;red&quot;,lwd=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div id="type-ii-functional-response" class="section level4">
<h4>Type II functional response</h4>
<p>The <strong>Type II functional response</strong> takes prey
saturation into account- the predators will consume more prey with
increasing prey densities, but only up to a point!</p>
<p>The type II functional response is described mathematically as:</p>
<p><span class="math inline">\(f(V,P) = \frac{\alpha V}{1+\alpha
hV}\)</span>,</p>
<p>where <em>f(V,P)</em> is the functional response (prey consumed per
predator).</p>
<p>Similar to the Type I functional response, <span
class="math inline">\(\alpha\)</span> is the “attack rate” (rate at
which predator-prey encounters increase as prey densities increase)</p>
<p>The new term, <em>h</em>, describes the handling time (average time a
predator spends processing a single prey item).</p>
<p>The term <em>h</em> is probably best understood as the <em>inverse of
the maximum prey consumption rate</em>!</p>
<p>Let’s visualize it!</p>
<pre class="r"><code>TypeIIfuncresp &lt;- function(V,alpha,h){
  (alpha*V)/(1+alpha*h*V)
}

curve(TypeIIfuncresp(x,0.1,0.1),0,500,xlab=&quot;Victim abundance&quot;,ylab=&quot;Total prey eaten per predator&quot;,col=&quot;red&quot;,lwd=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="type-iii-functional-response" class="section level4">
<h4>Type III functional response</h4>
<p>The <strong>Type III functional response</strong> takes predator
learning into account- as prey become more abundant (relative to other
potential prey) the predators will develop a <em>search image</em> and
the capture efficiency will increase with increasing prey abundance up
to a certain point.</p>
<p>Conversely, as prey densities get really low, predators will stop
even bothering to look for the prey, so capture efficiency will be
depressed.</p>
<p>The type III functional response can be described mathematically
as:</p>
<p><span class="math inline">\(f(V,P) = \frac{\alpha V}{1+\alpha
hV}\)</span>,</p>
<p>where <em>f(V,P)</em> is the functional response (prey consumed per
predator).</p>
<p>Similar to the Type I functional response, <span
class="math inline">\(\alpha\)</span> is the “attack rate” (rate at
which a predator-prey encounters increase as prey densities
increase)</p>
<p>The new term, <em>h</em>, describes the handling time (average time a
predator spends processing a single prey item).</p>
<p>The term <em>h</em> is probably best understood as the <em>inverse of
the maximum prey consumption rate</em>!</p>
<p>Let’s visualize it!</p>
<pre class="r"><code>TypeIIIfuncresp &lt;- function(V,alpha,h,k){
  (alpha*V^k)/(1+alpha*h*V^k)
}

curve(TypeIIIfuncresp(x,0.0005,0.1,1.6),0,1000,xlab=&quot;Victim abundance&quot;,ylab=&quot;Total prey eaten per predator&quot;,col=&quot;red&quot;,lwd=3)</code></pre>
<p><img src="LECTURE17_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="final-insightmaker-activity-on-your-own"
class="section level2">
<h2>Final InsightMaker activity (on your own)!!</h2>
<p><strong>Step 1</strong> Add prey density-dependence to your basic
predator-prey model, using your knowledge of modeling density-dependence
(or just use the equations in chapter 6 of the Gotelli book). Visualize
the dynamics as time series and in phase space. Do you ever see
oscillations with prey density dependence? Is this model more stable
than the base L-V model?</p>
<p><strong>Step 2</strong> Change the functional response to a type-II
functional response. Visualize the dynamics as time series and in phase
space. Do you ever see oscillations with this model? Is this model more
stable than the base L-V model?</p>
<p><strong>Step 3</strong> Change the model to account for prey refuges.
That is, there is a segment of the prey population that is not
accessible to predators. How does this change the system dynamics?</p>
<p><strong>Step 4</strong> Change the model to include a type II
functional response AND prey density-dependence. How does this change
the system dynamics? Is this system stable? Under what conditions?</p>
<p><strong>Step 5</strong> Evaluate the following statement (from the
Gotelli Book):</p>
<blockquote>
<p>“the more independent the predator and the prey are of one another,
the more stable the interaction”</p>
</blockquote>
<p><a href="LECTURE18.html">–go to next lecture–</a></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
