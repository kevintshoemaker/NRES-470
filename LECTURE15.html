<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 470/670" />


<title>Parameter estimation</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Malthus (Limits to growth)</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation (Logistic growth)</a>
    </li>
    <li>
      <a href="LECTURE5.html">Positive density dependence (Allee effect)</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="LECTURE12.html">Overview of PVA</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Parameter estimation</h1>
<h4 class="author">NRES 470/670</h4>
<h4 class="date">Spring 2023</h4>

</div>


<div id="parameter-estimation-for-wildlife-population-models"
class="section level1">
<h1>Parameter estimation for wildlife population models!</h1>
<p>We have now gone through the basic mechanics of population modeling.
But we have barely discussed where the parameter estimates come
from!</p>
<p>This is the focus of the current lecture- and much of NRES 488!</p>
<div id="data-requirements" class="section level2">
<h2>Data requirements</h2>
<div id="scalar-models-no-age-structure" class="section level3">
<h3>Scalar models (no age structure)</h3>
<ul>
<li>Initial abundance (<span class="math inline">\(N_0\)</span>)</li>
<li>Mean population growth rate (<span class="math inline">\(r\)</span>
or <span class="math inline">\(r_{max}\)</span>)</li>
<li>Variation in population growth rate (standard deviation for a normal
distribution representing environmental stochasticity)</li>
<li>Carrying capacity of the population (<span
class="math inline">\(K\)</span>; equilibrium abundance of logistic
model)</li>
</ul>
</div>
<div id="stage-structured-life-history-models" class="section level3">
<h3>Stage-structured (life history) models</h3>
<ul>
<li>Initial abundance (<span
class="math inline">\(\mathbf{N_0}\)</span>) (vector of initial
abundances for all stages)</li>
<li>Stage-specific vital rates (fecundity, survival; fill in a
transition matrix)</li>
<li>Temporal variation in specific vital rates (environmental
stochasticity)</li>
<li>Density-dependence of vital rates (e.g., how fecundity decreases as
population gets more crowded)
<ul>
<li>Which vital rates are density-dependent?</li>
</ul></li>
</ul>
</div>
<div id="metapopulation-spatial-models" class="section level3">
<h3>Metapopulation (spatial) models</h3>
<ul>
<li>Spatial distributions of suitable habitat patches (define
patches)</li>
<li>Spatial variation in vital rates (e.g., variation in habitat quality
among different patches)</li>
<li>Correlation in environmental stochasticity among patches</li>
<li>Dispersal rates among habitat patches</li>
<li>Habitat requirements of different life stages</li>
<li>For “classical” metapopulation models: rates of colonization and
extinction in habitat patches</li>
</ul>
</div>
</div>
<div id="data-sources" class="section level2">
<h2>Data sources!</h2>
<div id="census-data" class="section level3">
<h3>Census data!</h3>
<p>Census data is ultimately what we all <strong>wish</strong> we had!
It means we follow a population over time, and we know exactly how many
individuals of each stage are in the population each year. We have
<em>perfect detection!</em></p>
<p>In this case, computing survival and fecundity (and variation in
these parameters, and density-dependence) is relatively
straightforward!</p>
<p><img src="census1.png" style="width:40.0%" /></p>
<p><img src="census2.png" style="width:80.0%" /></p>
<p><img src="census3.png" style="width:80.0%" /></p>
<p><strong>PROS</strong> - Can estimate survival and fecundity, env.
stochasticity, density dependence- pretty much everything we want for a
population model!</p>
<p><strong>CONS</strong> - Very rarely (if ever) available!! - Ignores
<strong>imperfect detection</strong> (assumes no observation errors),
which is almost always not realistic.</p>
</div>
<div id="capture-mark-recapture-cmr" class="section level3">
<h3>Capture-mark-recapture (CMR)</h3>
<p><strong>PROS</strong> - Can estimate survival, variation in survival,
lambda, recruitment, dispersal rates. - Probably the most widely used
source of data for population models!</p>
<p><strong>CONS</strong> - Few downsides, although the analytical
techniques can be difficult to master - Mounting a proper CMR study can
be very costly, and require many years of data. - Estimating
landscape-scale movements can require an even more costly and
time-consuming study. - Emigration and survival can be difficult to
tease apart in many cases.</p>
<p>We will return to CMR data shortly (and in the optional Lab 7), but
first…</p>
</div>
<div id="what-if-theres-no-data" class="section level3">
<h3>What if there’s “no data”?</h3>
<p>Remember the <a
href="https://en.wikipedia.org/wiki/Stone_Soup">“Stone Soup”
analogy!</a> - even when you think there’s no data, there probably is
more than there initially appears!</p>
<ul>
<li>Use algebra to construct a full age-structured transition matrix
from available information
<ul>
<li>E.g., we are missing information on hatchling survival. We only
know:
<ul>
<li>Juvenile and adult survival rates<br />
</li>
<li>Nesting success<br />
</li>
<li>Population growth (lambda) is 1.09<br />
</li>
<li>Now we can solve for hatchling survival!<br />
</li>
<li>For an example of this, see <a
href="congdon%20et%20al%201993.pdf">Congdon et al 1993</a><br />
</li>
</ul></li>
</ul></li>
<li>Simplify! (Models are always simplified representations of reality)
<ul>
<li>Ignore age structure? (i.e., use scalar model)<br />
</li>
<li>Ignore density-dependence?<br />
</li>
<li>Ignore trophic interactions (we usually make this simplification
anyway!)<br />
</li>
<li>Ignore abundance entirely (e.g., use classical metapopulation
model)<br />
</li>
</ul></li>
<li>Conservative strategies (use <em>worst case scenario</em>)!
<ul>
<li>Density-independent model is conservative, so if you don’t have data
on D-D, then maybe just ignore it!<br />
</li>
<li>With parameter uncertainty, use the worst case scenario<br />
</li>
<li>Under decline trends, use the worst case scenario<br />
</li>
</ul></li>
<li>Use data from similar species!
<ul>
<li>E.g., tamarin species have similar life histories, so use data on
golden lion tamarins to model golden-headed lion tamarins.</li>
</ul></li>
<li>Expert Opinion
<ul>
<li>See below…</li>
</ul></li>
<li>National Databases
<ul>
<li>See <a href="FINAL_PROJECTS.html">links</a> on Final projects
page</li>
</ul></li>
<li><a
href="https://www.astronomyclub.xyz/maternal-effect/does-ecology-have-laws.html">Allometries</a>
<ul>
<li>e.g., Fenchel’s allometry</li>
<li>This type of thinking (looking for broad patterns across species) is
often called “Macroecology”</li>
</ul></li>
</ul>
<p><img src="allometry2.jpg" style="width:50.0%" /></p>
<p><img src="allometry1.jpg" style="width:50.0%" /></p>
</div>
</div>
<div id="aside--is-expert-opinion-okay-to-use" class="section level2">
<h2>Aside- is expert opinion okay to use???</h2>
<ul>
<li>Not ideal, because it is hard or impossible to validate, and hard to
document, but …</li>
<li>That is often the default in practice<br />
</li>
<li>And it is better to use it than to do nothing</li>
<li>And it is better to document that expert opinion was used than to
proceed with conservation planning in the absence of stating sources and
assumptions</li>
<li>It is a starting point (and sometimes a reasonable one)</li>
</ul>
</div>
<div id="capture-mark-recapture-cmr-analysis" class="section level2">
<h2>Capture-mark-recapture (CMR) analysis</h2>
<p><img src="statistics1.png" style="width:70.0%" /></p>
<div id="pva-parameters-estimable-from-cmr-data" class="section level3">
<h3>PVA Parameters estimable from CMR data</h3>
<ul>
<li>Survival rate (possibly age or size structured)</li>
<li>Fecundity (entry of new individuals in the population)</li>
<li>Recruitment (entry of new individuals into the adult
population)<br />
</li>
<li>Abundance</li>
<li>Lambda (finite rate of growth)</li>
<li>Environmental influences on survival rates and fecundity</li>
<li>Temporal process variance (env. stochasticity)</li>
<li>Dispersal rates</li>
</ul>
</div>
<div id="the-data-needed-for-cmr-analysis-capture-histories"
class="section level3">
<h3>The data needed for CMR analysis: capture histories</h3>
<p>Consider a project designed to monitor a population of alligators.
These alligators were monitored for four years, from 1976 to 1979.</p>
<p>Each row in the following table represents a unique possible history
of captures:</p>
<p>A “1” indicates that an animal was successfully captured in a given
year, and subsequently released.</p>
<p>A “0” indicates that an animal was not captured in a given year.</p>
<p>A “2” indicates that an animal was successfully captured in a given
year but was not released back into the population (probably died due to
handling or capture).</p>
<p><img src="caphist1.png" style="width:50.0%" /></p>
</div>
<div id="two-main-types-of-cmr-analyses" class="section level3">
<h3>Two main types of CMR analyses</h3>
<div id="closed-population-models" class="section level4">
<h4>Closed population models</h4>
<p>We assume that the population is closed (no BIDE processes!). That
is, abundance does not change! We attempt to estimate abundance!</p>
<ul>
<li>No mortality</li>
<li>No births</li>
<li>No immigration</li>
<li>No emigration</li>
<li>All individuals are observable (but not necessarily observed…)</li>
</ul>
<p><img src="peterson1.png" style="width:75.0%" /></p>
<p>Parameters estimated:</p>
<ul>
<li>Abundance</li>
</ul>
<p>M = the number of individuals marked in the first sample<br />
C = total number of individuals captured in 2nd sample<br />
R = number of individuals in 2nd sample that are marked</p>
<p>We can use the following formula to estimate abundance (the
<strong>lincoln-peterson estimator</strong>):</p>
<p><span class="math inline">\(N = \frac{M \times C}{R}\)</span></p>
</div>
<div id="open-population-models" class="section level4">
<h4>Open population models</h4>
<p>We assume that the population is open to one or more of the BIDE
processes. That is, abundance CAN change! We attempt to estimate the
processes driving abundance change (often, survival rates)</p>
<ul>
<li>Populations open to birth, death, and possibly even migration
(abundance can change during the study).</li>
<li>Enables estimation of the drivers of population dynamics over
extended time periods</li>
<li>Often of great interest to ecologists and managers.</li>
</ul>
</div>
<div id="key-assumptions-of-the-cjs-model" class="section level4">
<h4>Key assumptions of the CJS model</h4>
<ul>
<li>All individuals in population are equally detectable at each
sampling occasion (each capture session represents a totally random
sample from the population)<br />
</li>
<li>Marks are not lost or missed by surveyors<br />
</li>
<li>All emigration is permanent (equivalent to a mortality)</li>
</ul>
</div>
</div>
<div id="program-mark" class="section level3">
<h3>Program MARK</h3>
<p>MARK is a numerical maximum-likelihood engine designed for
mark-recapture analysis. You input a capture history dataset and MARK
will output results such as survival rate and capture probability!!</p>
</div>
</div>
<div id="example-of-an-open-population-mark-recapture-analysis"
class="section level2">
<h2>Example of an open-population mark-recapture analysis!</h2>
<p>Let’s run through a CJS analysis in R! To follow along, please <a
href="LECTURE15.R">save this script and load it up in Rstudio</a>.</p>
<p>NOTE: this analysis includes both males and females (unlike the
example in Lab 7), so the results will look somewhat different!</p>
<p><img src="dipper1.png" style="width:50.0%" /></p>
<p>The European dipper data is THE classic example of a CMR dataset.
Let’s look at it!</p>
<pre class="r"><code># Cormack-Jolly-Seber (CJS) model in R  --------------------------

library(marked)      # install the &#39;marked&#39; package if you haven&#39;t already done this!
data(&quot;dipper&quot;)
head(dipper,10)</code></pre>
<pre><code>##         ch    sex
## 1  0000001 Female
## 2  0000001 Female
## 3  0000001 Female
## 4  0000001 Female
## 5  0000001 Female
## 6  0000001 Female
## 7  0000001 Female
## 8  0000001 Female
## 9  0000001 Female
## 10 0000001 Female</code></pre>
<p>Here we use the “marked” package in R (instead of MARK) to do the ML
parameter estimation!</p>
<pre class="r"><code># load data!  ----------------------------

data(dipper)

# Process data  -------------------------------

dipper.proc=process.data(dipper,model=&quot;cjs&quot;,begin.time=1)  # Helper function- process the data for CJS model</code></pre>
<pre><code>## 255 capture histories collapsed into 53</code></pre>
<pre class="r"><code>dipper.ddl=make.design.data(dipper.proc)    # another helper function- process data!

# Fit models

# fit time-varying cjs model


capture.output(suppressMessages(   # note: this is just to suppress messages to avoid cluttering the website...
      mod.Phit.pt &lt;-  crm(dipper.proc,dipper.ddl,model.parameters=list(Phi=list(formula=~time),p=list(formula=~time)),method=&quot;Nelder-Mead&quot;,hessian = T)
),file=&quot;temp.txt&quot;) 

mod.Phit.pt   # print out model</code></pre>
<pre><code>## 
## crm Model Summary
## 
## Npar :  12
## -2lnL:  657.0644
## AIC  :  681.0644
## 
## Beta
##                    Estimate        se        lcl       ucl
## Phi.(Intercept)  0.75646636 0.6570806 -0.5314116 2.0443444
## Phi.time2       -0.99255899 0.7541098 -2.4706142 0.4854962
## Phi.time3       -0.84151202 0.6991672 -2.2118797 0.5288557
## Phi.time4       -0.22522075 0.7051952 -1.6074034 1.1569619
## Phi.time5       -0.36893542 0.6974964 -1.7360284 0.9981576
## Phi.time6        0.10115137 1.5063624 -2.8513189 3.0536216
## p.(Intercept)    1.00571207 0.8006508 -0.5635635 2.5749876
## p.time3          1.49463757 1.3119503 -1.0767850 4.0660601
## p.time4          1.37853596 1.0927336 -0.7632220 3.5202939
## p.time5          1.12053506 0.9914942 -0.8227937 3.0638638
## p.time6          1.57229762 1.0715540 -0.5279483 3.6725435
## p.time7          0.07823848 1.7821210 -3.4147187 3.5711956</code></pre>
<pre class="r"><code>mod.Phit.pt$results$AIC       # extract AIC</code></pre>
<pre><code>## [1] 681.0644</code></pre>
<pre class="r"><code># fit time-invariant cjs model

capture.output(suppressMessages(
  mod.Phidot.pdot &lt;- crm(dipper.proc,dipper.ddl,model.parameters = list(Phi=list(formula=~1),p=list(formula=~1)),method=&quot;Nelder-Mead&quot;,hessian = TRUE)
),file=&quot;temp.txt&quot;)

mod.Phidot.pdot</code></pre>
<pre><code>## 
## crm Model Summary
## 
## Npar :  2
## -2lnL:  666.8377
## AIC  :  670.8377
## 
## Beta
##                  Estimate        se        lcl       ucl
## Phi.(Intercept) 0.2422903 0.1020150 0.04234102 0.4422397
## p.(Intercept)   2.2261889 0.3251153 1.58896300 2.8634148</code></pre>
<pre class="r"><code>mod.Phidot.pdot$results$AIC</code></pre>
<pre><code>## [1] 670.8377</code></pre>
<pre class="r"><code># fit sex-dependent cjs model

capture.output(suppressMessages(
  mod.Phisex.psex &lt;- crm(dipper.proc,dipper.ddl,model.parameters = list(Phi=list(formula=~sex),p=list(formula=~sex)),method=&quot;Nelder-Mead&quot;,hessian = TRUE)
),file=&quot;temp.txt&quot;)

mod.Phisex.psex</code></pre>
<pre><code>## 
## crm Model Summary
## 
## Npar :  4
## -2lnL:  666.1518
## AIC  :  674.1518
## 
## Beta
##                   Estimate        se         lcl       ucl
## Phi.(Intercept) 0.22338784 0.1440981 -0.05904451 0.5058202
## Phi.sexMale     0.04138178 0.2041878 -0.35882631 0.4415899
## p.(Intercept)   2.01072100 0.4210671  1.18542943 2.8360126
## p.sexMale       0.47587463 0.6630165 -0.82363774 1.7753870</code></pre>
<pre class="r"><code>mod.Phisex.psex$results$AIC</code></pre>
<pre><code>## [1] 674.1518</code></pre>
<pre class="r"><code># compare all models with AIC   ----------------------------


# Set up models to run (must have either &quot;Phi.&quot; or &quot;p.&quot; in the name)
Phi.dot &lt;- list(formula=~1)       
Phi.time &lt;- list(formula=~time)
Phi.sex &lt;- list(formula=~sex)
Phi.timesex &lt;- list(formula=~sex+time)
p.dot &lt;- list(formula=~1)
p.time &lt;- list(formula=~time)
p.sex &lt;- list(formula=~sex)
p.timesex &lt;- list(formula=~sex+time)

cml=create.model.list(c(&quot;Phi&quot;,&quot;p&quot;))    # create list of all models to run


# Run all models   ----------------------------

capture.output(suppressMessages(suppressWarnings(
  allmodels &lt;- crm.wrapper(cml,data=dipper.proc, ddl=dipper.ddl,external=FALSE,accumulate=FALSE,method=&quot;Nelder-Mead&quot;,hessian=TRUE)
)),file=&quot;temp.txt&quot;)


# AIC model selection  ----------------------------

allmodels</code></pre>
<pre><code>##                             model npar      AIC  DeltaAIC       weight  neg2lnl
## 1                    Phi(~1)p(~1)    2 670.8377  0.000000 0.3792707172 666.8377
## 2                  Phi(~1)p(~sex)    3 672.1934  1.355756 0.1925531715 666.1934
## 5                  Phi(~sex)p(~1)    3 672.6762  1.838541 0.1512568696 666.6762
## 9                 Phi(~time)p(~1)    7 673.7301  2.892463 0.0893015564 659.7301
## 6                Phi(~sex)p(~sex)    4 674.1518  3.314151 0.0723253541 666.1518
## 10              Phi(~time)p(~sex)    8 675.1913  4.353613 0.0430104833 659.1913
## 13          Phi(~sex + time)p(~1)    8 675.6617  4.824056 0.0339952989 659.6617
## 14        Phi(~sex + time)p(~sex)    9 677.1681  6.330419 0.0160072363 659.1681
## 3                 Phi(~1)p(~time)    7 678.4804  7.642778 0.0083050299 664.4804
## 4           Phi(~1)p(~sex + time)    8 679.9497  9.112045 0.0039837661 663.9497
## 7               Phi(~sex)p(~time)    8 680.4921  9.654404 0.0030375415 664.4921
## 11             Phi(~time)p(~time)   12 681.0644 10.226756 0.0022815888 657.0644
## 12       Phi(~time)p(~sex + time)   13 681.7032 10.865580 0.0016577483 655.7032
## 8         Phi(~sex)p(~sex + time)    9 681.8896 11.051978 0.0015102292 663.8896
## 15       Phi(~sex + time)p(~time)   13 682.9670 12.129303 0.0008812611 656.9670
## 16 Phi(~sex + time)p(~sex + time)   14 683.6633 12.825655 0.0006221479 655.6633
##    convergence
## 1            0
## 2            0
## 5            0
## 9            0
## 6            0
## 10           0
## 13           0
## 14           0
## 3            0
## 4            0
## 7            0
## 11           0
## 12           0
## 8            0
## 15           0
## 16           1</code></pre>
<pre class="r"><code># get parameter estimates and confidence intervals for best model

allmodels[[1]]</code></pre>
<pre><code>## 
## crm Model Summary
## 
## Npar :  2
## -2lnL:  666.8377
## AIC  :  670.8377
## 
## Beta
##                  Estimate        se        lcl       ucl
## Phi.(Intercept) 0.2422903 0.1020150 0.04234102 0.4422397
## p.(Intercept)   2.2261889 0.3251153 1.58896300 2.8634148</code></pre>
<pre class="r"><code>allmodels[[11]]</code></pre>
<pre><code>## 
## crm Model Summary
## 
## Npar :  12
## -2lnL:  657.0644
## AIC  :  681.0644
## 
## Beta
##                    Estimate        se        lcl       ucl
## Phi.(Intercept)  0.75646636 0.6570806 -0.5314116 2.0443444
## Phi.time2       -0.99255899 0.7541098 -2.4706142 0.4854962
## Phi.time3       -0.84151202 0.6991672 -2.2118797 0.5288557
## Phi.time4       -0.22522075 0.7051952 -1.6074034 1.1569619
## Phi.time5       -0.36893542 0.6974964 -1.7360284 0.9981576
## Phi.time6        0.10115137 1.5063624 -2.8513189 3.0536216
## p.(Intercept)    1.00571207 0.8006508 -0.5635635 2.5749876
## p.time3          1.49463757 1.3119503 -1.0767850 4.0660601
## p.time4          1.37853596 1.0927336 -0.7632220 3.5202939
## p.time5          1.12053506 0.9914942 -0.8227937 3.0638638
## p.time6          1.57229762 1.0715540 -0.5279483 3.6725435
## p.time7          0.07823848 1.7821210 -3.4147187 3.5711956</code></pre>
<pre class="r"><code># make predictions and plot them. 

predict(allmodels[[1]])$Phi</code></pre>
<pre><code>##   occ estimate         se       lcl       ucl
## 1   6 0.560278 0.02513307 0.5105837 0.6087926</code></pre>
<pre class="r"><code>Phi_by_year &lt;- predict(allmodels[[11]])$Phi    # predict Phi for all years (based on the best Phi(t) model)

suppressWarnings( suppressMessages( library(Hmisc,quietly = T) ))    #load Hmisc package- has a nice error bar function
plot(1:nrow(Phi_by_year),Phi_by_year$estimate,xlab=&quot;Year&quot;,ylab=&quot;Survival&quot;,ylim=c(0,1),main=&quot;Variability in Survival, dipper demo&quot;)
errbar(1:nrow(Phi_by_year),Phi_by_year$estimate,Phi_by_year$ucl,Phi_by_year$lcl,add=T)</code></pre>
<p><img src="LECTURE15_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>What is our estimate for mean survival?</p>
<pre class="r"><code># Compute the mean survival rate for the population  -----------------------

mean(Phi_by_year$estimate)</code></pre>
<pre><code>## [1] 0.5880352</code></pre>
<p>What is the environmental stochasticity?</p>
<pre class="r"><code># Compute the environmental variablility in annual survival rates ----------------

sd(Phi_by_year$estimate)</code></pre>
<pre><code>## [1] 0.1066587</code></pre>
<p><a href="LECTURE16.html">–go to next lecture–</a></p>
</div>
<div id="extras" class="section level2">
<h2>Extras</h2>
<div id="maximum-likelihood-a-framework-for-statistical-inference"
class="section level3">
<h3>Maximum likelihood: a framework for statistical inference!</h3>
<p><strong>FOR CMR ANALYSIS</strong>: - What value of survival maximizes
the probability of generating the observed capture histories?</p>
<p>EXAMPLE:</p>
<p>Consider the following capture history for a single individual:</p>
<pre><code>1 0 1 1</code></pre>
<p>This individual was marked and released upon initial capture. It was
not captured in the next survey, but then was captured in each of the
next two subsequent surveys.</p>
<p>What is the probability of observing this capture history?</p>
<blockquote>
<p>[(Probability of surviving from time 1 to 2) X (Probability of not
being seen at time 2)] X [(Probability of surviving from time 2 to 3) X
(Probability of being seen at time 3)] X [(Probability of surviving from
time 3 to 4) X (Probability of being seen at time 4)]</p>
</blockquote>
<p>This can be written:</p>
<p><span class="math inline">\(L_1 = \phi_1(1-p_2) \cdot \phi_2p_3 \cdot
\phi_3p_4\)</span></p>
<p>How about the following capture history for a single individual:</p>
<pre><code>1 0 1 0</code></pre>
<p>What is the probability of observing this capture history?</p>
<blockquote>
<p>[(Probability of surviving from time 1 to 2) X (Probability of not
being seen at time 2)] X [(Probability of surviving from time 2 to 3) X
(Probability of being seen at time 3)] X</p>
</blockquote>
<p>– either –</p>
<blockquote>
<p>[(Probability of surviving from time 3 to 4) X (Probability of not
being seen at time 4)]</p>
</blockquote>
<p>– or –</p>
<blockquote>
<p>[(Probability of NOT surviving from time 3 to 4)</p>
</blockquote>
<p>This can be written:</p>
<p><span class="math inline">\(L_1 = \phi_1(1-p_2) \cdot \phi_2p_3 \cdot
\left \{(1-\phi_3)+\phi_3(1-p_4) \right \}\)</span></p>
<p><strong>Q</strong>: if survival were 100% and capture probability
were 100%, what is the probability of observing the above capture
histories?</p>
<p><strong>Q</strong>: what about if survival was 100% and capture
probability was 75%?</p>
<p>Maximum likelihood estimation is the process of finding those values
of the parameters <span class="math inline">\(\phi\)</span> and <span
class="math inline">\(p\)</span> that would be most <em>likely</em> to
generate the observed capture histories!</p>
<p>This model is known as the <em>Cormack-Jolly-Seber</em> model (CJS),
and is the most common analysis performed by Program MARK.</p>
<p><strong>Q</strong>: Why is <span class="math inline">\(\phi\)</span>
also known as “apparent” survival? Why is it not “true” survival???</p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
