<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 470/670" />


<title>Matrix population models</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Malthus (Limits to growth)</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation (Logistic growth)</a>
    </li>
    <li>
      <a href="LECTURE5.html">Positive density dependence (Allee effect)</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="LECTURE12.html">Overview of PVA</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Matrix population models</h1>
<h4 class="author">NRES 470/670</h4>
<h4 class="date">Spring 2024</h4>

</div>


<div id="matrix-population-models" class="section level1">
<h1>Matrix population models</h1>
<p>First of all, this lecture is full of R code (R makes it easy to run
matrix population models!). If you want to follow along in R, you can
find the R script <a href="LECTURE7.R">here</a>. I recommend
right-clicking on the link, saving the script to a designated folder,
and loading up the script in RStudio.</p>
<div id="why-matrices" class="section level2">
<h2>Why matrices?</h2>
<div id="reason-1-simplify" class="section level3">
<h3>Reason 1: simplify!</h3>
<p><img src="IM7.jpg" /></p>
<p>You might recognize this InsightMaker model from Lab 3. This
represents an age-structured population with only three age classes.
Imagine if there were five age classes, or 10? What if you could jump
from (e.g.) stage 3 to stage 5? Or from stage 5 back to stage 3? How
many lines would you have to draw, how many equations would you have to
put in all the different flows? It would be tedious, and you could
easily run into errors that would be hard to uncover!</p>
<p><img src="teasel1.jpg" style="width:30.0%" /></p>
<p>Consider the teasel example from our textbook. It’s possible to
implement this model in InsightMaker, but it would be tedious and
potentially prone to error. And this is far from the most complicated
populations out there (although notice that plants can do some things
that vertebrate animals can’t do- for instance go backwards in
developmental stage. With matrix models, there is an easier way!</p>
<p><img src="gotelli3_6.jpg" style="width:50.0%" /></p>
<p>The population vital rates for pretty much any age-structured or
stage-structured population can be represented as a <strong>transition
matrix</strong> (or, projection matrix), which summarizes all the
information about survival, birth rates, and transitions between stages!
(and the fact that a life history like teasel can be represented by a
transition matrix illustrates the generality of this concept!)</p>
<p>For example, the teasel vital rates can be summarized in <a
href="teaselmatrix1.csv">this matrix</a>:</p>
<pre class="r"><code># Teasel example -------------------------------

# Teasel example from Gotelli: summarizing a complex life history!

teasel &lt;- read.csv(&quot;teaselmatrix1.csv&quot;, header=T)      # read in the teasel transition matrix from Gotelli
teasel &lt;- teasel[,-1]                                  # remove the row names
teasel_matrix &lt;- as.matrix(teasel)                     # convert to a matrix (from a data frame)
colnames(teasel_matrix) &lt;- names(teasel)               # assign row and column names
rownames(teasel_matrix) &lt;- names(teasel)
teasel_matrix                                          # print the matrix</code></pre>
<pre><code>##           seed1 seed2  ros1  ros2  ros3 flowering
## seed1     0.000  0.00 0.000 0.000 0.000   322.380
## seed2     0.966  0.00 0.000 0.000 0.000     0.000
## ros1      0.013  0.01 0.125 0.000 0.000     3.448
## ros2      0.007  0.00 0.125 0.238 0.000    30.170
## ros3      0.008  0.00 0.000 0.245 0.167     0.862
## flowering 0.000  0.00 0.000 0.023 0.750     0.000</code></pre>
<div id="stage-structure-vs-age-structure" class="section level4">
<h4>Stage-structure vs age-structure</h4>
<p>In the previous module, we talked about ‘age-structured populations’.
What we meant by that is that the population vital rates (e.g., <span
class="math inline">\(b\)</span> and <span
class="math inline">\(d\)</span>) varied by age.</p>
<p>Sometimes, it’s convenient to classify individuals within a certain
age range as belonging to a particular life-history stage. For example,
we might classify the life history of a grizzly bear like this:</p>
<p>Age 0-1: newborn<br />
Age 1-2: yearling<br />
Age 2-5: subadult<br />
Age 6+: adult</p>
<p>This can simplify our models considerably. For example, consider a
species like a sea turtle, with up to 75 or 100 years of life. You could
build a model in which you have 100 [Stocks], one for each year of
life.</p>
<p>–OR–</p>
<p>You could have 5 [Stocks] representing age ranges over which sea
turtles tend to have similar vital rates. For example, we might divide
the sea turtle life history into the following stages:</p>
<p>Age 0-1: hatchling<br />
Age 1-5: young juvenile<br />
Age 5-10: older juvenile<br />
Age 10-17: subadult<br />
Age 18+: adult</p>
<p>By using stages, we have simplified our model from having 100 stocks
(with even more associated flows/transitions) to a model with only 5
stocks- and we are still accurately representing how vital rates change
with age (i.e., the model is still <em>biologically realistic</em>).</p>
<p>Matrix population models can represent age-structured and
stage-structured models with equal simplicity and elegance.</p>
<p>The term ‘Leslie Matrix’ refers to an age-structured matrix
population model.</p>
<p>When a matrix is used to represent a stage-structured population, it
is often called a “Lefkovitch” (or stage-based) Matrix.</p>
</div>
</div>
<div id="reason-2-modeling-age-structured-population-dynamics"
class="section level3">
<h3>Reason 2: modeling age-structured population dynamics!</h3>
<p>In one of the questions in Lab 3, you were asked to use a life table
to predict the number of births in a population one time step into the
future. As you probably realized, this is not as straightforward as it
sounds!</p>
<p>Life tables are great for summarizing survivorship schedules and
other aspects of age-structured populations. But life tables are not
designed to model the abundance dynamics of age- or stage- structured
populations!</p>
<p>You know what <em>is</em> great for projecting age-structured
abundance into the future?</p>
<p>MATRICES of course!</p>
<p>For example, let’s project a teasel population 1 year into the
future:</p>
<p>First of all, we need to begin with a teasel population
<strong>vector</strong>…</p>
<pre class="r"><code># Summarize initial age-structured abundance as a matrix with one column

Initial_teasel &lt;- matrix(c(1000,1500,200,300,600,25),ncol=1)         # initial population size (population vector; matrix with 1 column!)
rownames(Initial_teasel) &lt;- rownames(teasel_matrix)                  # add row and column names
colnames(Initial_teasel) &lt;- &quot;Abundance&quot;
Initial_teasel</code></pre>
<pre><code>##           Abundance
## seed1          1000
## seed2          1500
## ros1            200
## ros2            300
## ros3            600
## flowering        25</code></pre>
<p>Then all we need to do is ‘matrix-multiply’ this
<strong>vector</strong> of abundances by the <strong>transition
matrix</strong> from above! Each time we do this multiplication step, we
advance one year! It’s that easy!</p>
<p>NOTE: matrix multiplication (percent-asterisk-percent in R) is not
the same as standard multiplication (asterisk in R).</p>
<p>Here’s how we can do this in R!</p>
<pre class="r"><code># Project the population at time 1

Year1 &lt;- teasel_matrix %*% Initial_teasel   # note: the &#39;%*%&#39; denotes &#39;matrix multiplication&#39; in R. We&#39;ll go through this more later.     
Year1</code></pre>
<pre><code>##           Abundance
## seed1       8059.50
## seed2        966.00
## ros1         139.20
## ros2         857.65
## ros3         203.25
## flowering    456.90</code></pre>
<p>Pretty simple!</p>
<p>To compute teasel abundance in year 2 of our simulation, we can
simply repeat:</p>
<pre class="r"><code># Project the population at time 2

thisYear &lt;- Year1
nextYear &lt;- teasel_matrix %*% thisYear
nextYear  # now we get the (age structured) population size at time 2!     </code></pre>
<pre><code>##             Abundance
## seed1     147295.4220
## seed2       7785.4770
## ros1        1707.2247
## ros2       14062.6102
## ros3         702.3908
## flowering    172.1635</code></pre>
<p>We could use this strategy to simulate abundance for ten years (or
20, or 30, or 10000)…</p>
<p>Notice the use of a <strong>for loop</strong> here!</p>
<pre class="r"><code># Use a FOR loop to project the population dynamics for the next 10 years!

nYears &lt;- 10
tenYears &lt;- matrix(0,nrow=6,ncol=nYears+1)          # initialize storage array for recording age structured abundances for the next 10 years. 
rownames(tenYears) &lt;- rownames(Initial_teasel)      # assign row and column names
colnames(tenYears) &lt;- seq(0,10)
tenYears[,1] &lt;- Initial_teasel                      # initialize the simulated abundances

# run the for loop!

for(t in 2:(nYears+1)){    # here we use &#39;t&#39; as our looping variable, but we could choose any name we want
  tenYears[,t] &lt;-  teasel_matrix %*% tenYears[,t-1]     # perform matrix multiplication for each year of the simulation!
}

tenYears</code></pre>
<pre><code>##              0       1           2           3          4           5
## seed1     1000 8059.50 147295.4220  55502.0530 274098.158 1254742.541
## seed2     1500  966.00   7785.4770 142287.3777  53614.983  264778.821
## ros1       200  139.20   1707.2247   2799.7179   5425.969   18197.711
## ros2       300  857.65  14062.6102   9785.5436  28718.972  126857.393
## ros3       600  203.25    702.3908   4889.4070   4390.907   13317.225
## flowering   25  456.90    172.1635    850.2331   3892.123    3953.716
##                    6          7           8          9         10
## seed1     1274599.05 4160519.75 12493783.29 19821259.9 54739267.1
## seed2     1212081.29 1231262.68  4019062.08 12068994.7 19147337.1
## ros1        34866.57   77547.56   209719.50   440822.1  1018930.3
## ros2       160533.59  440850.62  1312972.86  2281135.7  5859547.7
## ros3        46750.08   68459.45   186131.95   505712.0   948267.5
## flowering   12905.64   38754.83    61484.15   169797.3   431750.1</code></pre>
<p>Finally, we can plot out the abundance of each stage over 10
years!</p>
<p><img src="LECTURE7_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>So projection is easy with matrices! What more reason do we need to
convince ourselves of why matrix population models are worth knowing?
Well, how about this…</p>
</div>
<div id="reason-3-matrix-algebra-tricks" class="section level3">
<h3>Reason 3: Matrix algebra ‘tricks’!</h3>
<p>Fortunately, we can compute two key population properties from the
transition matrix using some mathematical tricks:</p>
<ol style="list-style-type: decimal">
<li>We can compute <strong>Lambda</strong> from the transition matrix in
one step</li>
<li>We can compute **Stable Stage Distribution (SSD) from the transition
matrix in one step</li>
</ol>
<div id="lambda" class="section level4">
<h4>Lambda</h4>
<p>There is a clear similarity between the finite population growth
equation:</p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t\)</span>,</p>
<p>where <span class="math inline">\(N\)</span> is abundance (as
always), <span class="math inline">\(t\)</span> is time, often in years
but could be any time units, and <span
class="math inline">\(\lambda\)</span> is the multiplicative growth rate
over the time period <span class="math inline">\(t \rightarrow
t+1\)</span></p>
<p>… and the matrix population growth equation:</p>
<p><span class="math inline">\(\mathbf{N}_{t+1} = \mathbf{A} \cdot
\mathbf{N}_{t}\)</span>,</p>
<p>where <span class="math inline">\(\mathbf{N}\)</span> is a
<strong>vector</strong> of abundances (abundance for all stages), and
<span class="math inline">\(\mathbf{A}\)</span> is the
<strong>transition matrix</strong>, which we have seen before.</p>
<p>Both equations describe discrete exponential growth or decline!</p>
<p>Note that <span class="math inline">\(N\)</span> in the first
equation is a <strong>scalar</strong> – that is, it is just a single
number.</p>
<p>In contrast:</p>
<p><span class="math inline">\(\mathbf{N}\)</span> in the second
equation represents an age-structured <strong>vector (a bundle of
numbers organized in a single line)</strong>: a set of abundances
structured by age or stage class.</p>
<p>Similarly, the finite population growth rate, <span
class="math inline">\(\lambda\)</span> is a scalar,</p>
<p>In fact, the concept of <strong>Lambda</strong>, or the multiplier
used to model discrete population growth, applies to matrix population
models as well!</p>
<p>As you may have noticed from our age-structured InsightMaker model
from class (or from Lab 3), age-structured models sometimes exhibit
“messy” dynamics at first, when the population is jumping up and down a
lot. However, after some time, the population growth becomes smooth-
this is when the population has achieved <em>stable stage distribution
(SSD)</em>. At SSD, the population grows in a discrete exponential
growth pattern- this rate of exponential growth can be described by a
single parameter – <strong>Lambda</strong>!</p>
<p><span class="math inline">\(\mathbf{A}\)</span> is a <strong>matrix
(a bundle of numbers organized in rows and columns)</strong> known as
the transition matrix in Population Ecology.</p>
<p>In one step, you can compute <span
class="math inline">\(\lambda\)</span> from <span
class="math inline">\(\mathbf{A}\)</span>!!</p>
<p>Let’s do this in R!</p>
<p>What is the growth rate <span class="math inline">\(\lambda\)</span>
for the teasel population. If you recall, it looked like it was growing,
so it should be above 1…</p>
<pre class="r"><code># Matrix &quot;tricks&quot; for population ecology ---------------------------

# Use the transition matrix to compute Lambda, or the finite rate of population growth!

library(popbio)      # load the &#39;popbio&#39; package in R!
Lambda &lt;- lambda(teasel_matrix) 
Lambda</code></pre>
<pre><code>## [1] 2.32188</code></pre>
<pre class="r"><code>#   as.numeric(round(eigen(teasel_matrix)$values[1],2))  # this is an alternative method- if you don&#39;t want to use the &#39;popbio&#39; package</code></pre>
<p>You don’t have to understand the math here- but I do want you to
understand how simple that was- just one line of code and we computed
the annual rate of growth from the teasel transition matrix!</p>
</div>
<div id="stable-stage-distribution-ssd" class="section level4">
<h4>Stable Stage Distribution (SSD)</h4>
<p>Here’s another trick:</p>
<p>In one step, you can compute <strong>stable stage distribution
(SSD)</strong> from <span
class="math inline">\(\mathbf{A}\)</span>!!</p>
<p>Let’s do this in R!</p>
<p>What is the stable age distribution for the teasel population. If you
recall, the first seed stage looked like it dominated in the figure
above.</p>
<pre class="r"><code># Compute stable age distribution from the transition matrix!

library(popbio)    # ... and it&#39;s even easier if we use the &#39;popbio&#39; package...
SAD &lt;- stable.stage(teasel_matrix)  
SAD      # stable age distribution as a percentage of the total population</code></pre>
<pre><code>##       seed1       seed2        ros1        ros2        ros3   flowering 
## 0.636901968 0.264978062 0.012174560 0.069281759 0.012076487 0.004587164</code></pre>
<pre class="r"><code># #abs(as.numeric(round(eigen(teasel_matrix)$vectors[,1],3)))  # alternative- doesn&#39;t use &#39;popbio&#39;
# SAD/sum(SAD)</code></pre>
<p>This vector represents the <em>relative abundances in each age class
at the stable age distribution</em>!</p>
<p><strong>Q:</strong> Does a stage-structured population grow at the
rate of <span class="math inline">\(\lambda\)</span> per time step if it
is NOT at stable stage distribution (SSD)? [Top Hat]</p>
<p>To answer this question, you may find it helps to load an
stage-structured model in InsightMaker like <a
href="https://insightmaker.com/insight/6vZsNuzGIbisYsFVCSLWZK/Stage-structured-population">this
one</a>.</p>
</div>
</div>
</div>
<div id="mechanics-of-matrix-population-models" class="section level2">
<h2>Mechanics of matrix population models</h2>
<p>Let’s take a look at a basic stage-structured population –
specifically <a
href="https://insightmaker.com/insight/6vZsNuzGIbisYsFVCSLWZK/Stage-structured-population">this
one</a> - we used this model for running the ‘supplementation’ example
in the ‘age structured populations’ lecture. In InsightMaker, it looks
something like this:</p>
<p><img src="IM9.jpg" /></p>
<p>Let’s convert the vital rates to a three-stage <strong>projection
matrix</strong>. Projection matrices are <strong>square
matrices</strong> where the number of rows and columns are equal to the
number of life stages. In this case, that means three! Let’s make a
blank matrix for now:</p>
<pre class="r"><code># Demo -------------------------
# In class demo: convert an insightmaker model to a matrix projection model

# First, we specify a blank transition matrix

TMat &lt;- matrix(0,nrow=3,ncol=3)                    # create a blank matrix with 3 rows and 3 columns
stagenames &lt;- c(&quot;Yearlings&quot;,&quot;Subadults&quot;,&quot;Adults&quot;)  # name the rows and columns
rownames(TMat) &lt;- stagenames
colnames(TMat) &lt;- stagenames
TMat                                               # now we have an all-zero transition matrix.</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings         0         0      0
## Subadults         0         0      0
## Adults            0         0      0</code></pre>
<p>You can read the <strong>elements</strong> of a transition matrix as
follows:</p>
<p>“The per-capita rate of transition from <em>(col name)</em> this year
to <em>(row name)</em> next year is <em>(value of element)</em>”</p>
<p>NOTE: the top row in the transition matrix represents
<strong>fecundities (f)</strong>. These elements are best interpreted as
follows:</p>
<p>“The per-capita production of one-year-olds (yearlings) next year by
<em>(col name)</em> in the population this year is <em>(value of
element)</em>”.</p>
<p>These matrix elements account for both the birth rate (per-capita
birth rate this year) and the survival from birth to age 1. That is, in
order for a female to add a new individual to the population next year,
she has to give birth and then the offspring need to survive until their
first birthday!</p>
<p>In life table terms:</p>
<p><span class="math inline">\(f_t = b(t) * g(0)\)</span></p>
<p>Now we can start filling in this matrix. Let’s begin with the top
left <strong>element</strong> of the matrix (a
<strong>fecundity</strong> term, since it’s part of the top row). This
represents the per-capita production of yearlings (col) next year by
yearlings (row) this year. What is the value of this element?</p>
<p>Let’s update our transition matrix:</p>
<pre class="r"><code># fill in the top left element of the matrix

TMat[1,1] &lt;- 0    # yearlings have birth rate of zero, so also a fecundity of zero!
TMat</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings         0         0      0
## Subadults         0         0      0
## Adults            0         0      0</code></pre>
<p>How about the second row, first column. This represents the
per-capita transition from yearling (col) this year to subadult (row)
next year. That is, the transition rate from yearling to subadult. In
this model, this is the same as the yearling survival- because all
survivors must transition to the subadult stage (you either transition
or die- you can’t stay a yearling for more than one year!) The value
from our model is 0.3.</p>
<p>Let’s update our transition matrix:</p>
<pre class="r"><code># update the second row, first column (yearling survival, or transition from ylng to sub)

TMat[2,1] &lt;- 0.3


# and the survival of adults (transition from adult to adult)

TMat[3,3] &lt;- 0.85    # 85% survival


# transition from sub to sub (survive and stay subadult) 

TMat[2,2] &lt;- 0.6-0.1    # 50% of subadults survive and stay juvenile


# transition from subadult to adult

TMat[3,2]  &lt;- 0.1   # 10% of juveniles survive and transition to adult. </code></pre>
<p>What about the transition from the yearling to the adult stage? Well,
we can set that to zero because you can’t skip right to adult from
yearling- you must pass through the subadult stage!!</p>
<pre class="r"><code># fill in the bottom left element of the matrix

TMat[3,1] &lt;- 0    # yearlings (col 1) can&#39;t become adults (row 3) next year!
TMat</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings       0.0       0.0   0.00
## Subadults       0.3       0.5   0.00
## Adults          0.0       0.1   0.85</code></pre>
<p>What about the transition from the adult to the subadult stage? We
can set that to zero as well- because you can’t revert to the subadult
stage if you’re already an adult!!</p>
<pre class="r"><code># fill in the bottom left element of the matrix

TMat[2,3] &lt;- 0    # adults (col 3) can&#39;t become subadults (row 2) next year!
TMat</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings       0.0       0.0   0.00
## Subadults       0.3       0.5   0.00
## Adults          0.0       0.1   0.85</code></pre>
<p>And the hardest part is usually the top row: the fecundity row. In
this case, this year’s yearlings don’t produce offspring, so they have
fecundity of zero.</p>
<p>Subadults have a birth rate of 3 females per female, and adults have
a birth rate of 7 female offspring per female.</p>
<p>But remember, in order for these offspring to enter the population as
yearlings next year, they must survive that first year of life!!</p>
<pre class="r"><code>TMat[1,2] &lt;- 3 * 0.3      # subadult fecundity term: birth rate multiplied by first-year survival

TMat[1,3] &lt;- 7 * 0.3   # subadult fecundity term: birth rate multiplied by first-year survival</code></pre>
<p>In the end we get the following matrix:</p>
<pre class="r"><code>TMat</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings       0.0       0.9   2.10
## Subadults       0.3       0.5   0.00
## Adults          0.0       0.1   0.85</code></pre>
<p>See if you can understand what this matrix is saying about the
transitions from and two the three life stages.</p>
<pre class="r"><code># alternatively, you can fill in the matrix like this:

TMat[,1] &lt;- c(0,0.3,0)              # fill in the entire first column of the transition matrix
TMat[,2] &lt;- c(3*0.3,0.5,0.1)        # fill in the entire second column of the transition matrix
TMat[,3] &lt;- c(7*0.3,0,0.85)         # fill in the entire third column of the transition matrix
TMat</code></pre>
<pre><code>##           Yearlings Subadults Adults
## Yearlings       0.0       0.9   2.10
## Subadults       0.3       0.5   0.00
## Adults          0.0       0.1   0.85</code></pre>
<p>Now we can run a 50-year projection and compare it with the
InsightMaker model. It should look the same!!</p>
<p>First we must specify the initial abundances in each stage:</p>
<pre class="r"><code># specify initial abundance vector

InitAbund &lt;- c(40,0,0)
names(InitAbund) &lt;- colnames(TMat)
InitAbund</code></pre>
<pre><code>## Yearlings Subadults    Adults 
##        40         0         0</code></pre>
<p>So we are starting with only Juveniles…</p>
<pre class="r"><code># Run the model for 50 years (using for loop)

nYears &lt;- 50
allYears &lt;- matrix(0,nrow=nrow(TMat),ncol=nYears+1)
rownames(allYears) &lt;- rownames(TMat)
colnames(allYears) &lt;- seq(0,nYears)
allYears[,1] &lt;- InitAbund 

for(t in 2:(nYears+1)){
  allYears[,t] &lt;-  TMat %*% allYears[,t-1]    # matrix multiplication!
}

allYears</code></pre>
<pre><code>##            0  1    2    3     4       5        6         7         8         9
## Yearlings 40  0 10.8 7.92 9.018 9.14850 9.634005 10.086392 10.600134 11.142728
## Subadults  0 12  6.0 6.24 5.496 5.45340 5.471250  5.625827  5.838831  6.099456
## Adults     0  0  1.2 1.62 2.001 2.25045 2.458223  2.636614  2.803705  2.967032
##                  10        11        12        13        14        15        16
## Yearlings 11.720277 12.330329 12.974037 13.652323 14.366661 15.118705 15.910307
## Subadults  6.392546  6.712356  7.055277  7.419850  7.805622  8.212809  8.642016
## Adults     3.131923  3.301389  3.477416  3.661332  3.854117  4.056561  4.269358
##                  17        18        19       20        21        22       23
## Yearlings 16.743466 17.620318 18.543126 19.51428 20.536315 21.611881 22.74378
## Subadults  9.094100  9.570090 10.071140 10.59851 11.153539 11.737664 12.35240
## Adults     4.493156  4.728593  4.976313  5.23698  5.511284  5.799945  6.10372
##                  24        25        26        27        28        29        30
## Yearlings 23.934968 25.188542 26.507772 27.896096 29.357133 30.894691 32.512777
## Subadults 12.999333 13.680157 14.396641 15.150652 15.944155 16.779217 17.658016
## Adults     6.423401  6.759824  7.113866  7.486451  7.878548  8.291181  8.725426
##                  31        32       33       34       35       36       37
## Yearlings 34.215609 36.007625 37.89350 39.87814 41.96673 44.16470 46.47780
## Subadults 18.582841 19.556103 20.58034 21.65822 22.79255 23.98629 25.24256
## Adults     9.182414  9.663336 10.16945 10.70206 11.26258 11.85244 12.47321
##                 38       39       40       41       42       43       44
## Yearlings 48.91204 51.47377 54.16967 57.00676 59.99245 63.13451 66.44113
## Subadults 26.56462 27.95592 29.42009 30.96095 32.58250 34.28899 36.08485
## Adults    13.12648 13.81397 14.53747 15.29886 16.10012 16.94335 17.83075
##                 45       46       47       48       49       50
## Yearlings 69.92094 73.58299 77.43685 81.49254 85.76065 90.25230
## Subadults 37.97476 39.96366 42.05673 44.25942 46.57747 49.01693
## Adults    18.76462 19.74741 20.78166 21.87008 23.01551 24.22093</code></pre>
<p>Now let’s plot it out!</p>
<pre class="r"><code># and plot out the results!

plot(1,1,pch=&quot;&quot;,ylim=c(0,100),xlim=c(0,nYears+1),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;,xaxt=&quot;n&quot;)
cols &lt;- rainbow(3)
for(s in 1:3){
  points(allYears[s,],col=cols[s],type=&quot;l&quot;,lwd=2)
}
axis(1,at=seq(1,nYears+1),labels = seq(0,nYears))
legend(&quot;topleft&quot;,col=cols,lwd=rep(2,3),legend=rownames(allYears),bty=&quot;n&quot;)</code></pre>
<p><img src="LECTURE7_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Does this look the same as the InsightMaker results? Check it to make
sure!</p>
</div>
<div id="limitations-of-matrix-population-models"
class="section level2">
<h2>Limitations of matrix population models</h2>
<p>Matrix population models are great, but they have some limitations
too.</p>
<div id="what-about-density-dependence" class="section level3">
<h3>What about density-dependence?</h3>
<p>In some ways, while introducing a new level of realism in our models
– age-structure – we have been ignoring another type of realism that we
introduced in earlier lectures- <strong>density-dependence</strong>
(both positive and negative)!</p>
<p>Which vital rates are density-dependent? All? Some? It depends? Are
the data available?</p>
<p>How do you incorporate density-dependence into a matrix population
model?</p>
<p>How do you incorporate predator-prey dynamics into a matrix
population model?</p>
<p>ANSWER: use computer programming (e.g., R or InsightMaker!)</p>
</div>
<div id="overview-of-matrix-multiplication" class="section level3">
<h3>Overview of matrix multiplication</h3>
<p>(we will do this on the whiteboard!)</p>
</div>
<div id="in-class-exercise-loggerhead-conservation"
class="section level3">
<h3>In-class exercise: loggerhead conservation!</h3>
<p>First, please review the introduction to loggerhead sea turtles <a
href="PVA3_421.html">here</a>.</p>
<p>Next, download the Excel document for this example <a
href="Loggerhead2024.xlsx">here</a>. We will work through the Excel
example in class.</p>
<p>NOTE: a worked version of the spreadsheet can be found <a
href="Loggerhead2024_worked.xlsx">here</a></p>
<p>Using your Excel spreadsheet, investigate four management scenarios
for the loggerhead turtle population:</p>
<ol style="list-style-type: decimal">
<li>Improve fecundity (both subadults and adults) via <em>nest-site
protection</em>!
<ul>
<li>Increase fecundity by 50% (improve to 1.5 times the current
value)<br />
</li>
</ul></li>
<li>Improve hatchling survival via <em>nest monitoring</em>
<ul>
<li>Improve <em>to</em> 100%<br />
</li>
</ul></li>
<li>Improve large juvenile survival using <em>Turtle Excluder Devices
(TEDs)</em>
<ul>
<li>Add 0.25 to the existing large juvenile survival (prob of transition
from LJ to LJ)<br />
</li>
</ul></li>
<li>Improve adult survival by <em>restricting longline fisheries</em>.
<ul>
<li>Increase by 10% (add 0.1 to adult survival)</li>
</ul></li>
</ol>
<div class="float">
<img src="TED1.jpg" alt="turtle excluder device" />
<div class="figcaption">turtle excluder device</div>
</div>
<p><strong>Top Hat</strong>: Which of the four management
recommendations would have the greatest positive effect on this
population?</p>
<p>Click this link to download a CSV file of the loggerhead transition
matrix (for reading into R): <a href="LoggerheadMatrix.csv">CSV
link</a></p>
</div>
<div
id="translate-life-history-description-into-matrix-population-model"
class="section level3">
<h3>translate life history description into matrix population model</h3>
<p>If we have time, we may review the final question from Lab 4:</p>
<p>Translate the following paragraph into a matrix population model.
Remember a matrix population model has two components- an
<strong>initial abundance vector</strong> and a <strong>transition
matrix</strong>.</p>
<p><img src="redtail1.jpg" /></p>
<blockquote>
<p>We assumed that the tawny rat-hawk life history could be described in
terms of four major life stages: juvenile (one-year-olds), subadults
(2-year-olds), non-territorial adults, and territorial adults (all
individuals 3 years old and beyond are considered adults). We assumed
that territorial adult females experienced an average of 10% mortality
each year, and non-territorial adults experienced 18% mortality
annually. Juvenile female mortality was 25% per year, and subadult
mortality was 20%. Hatchlings (newborns) had a 30% chance of surviving
their first year of life. We assumed that 90% of surviving subadults
would become non-territorial adults, while the remaining 10% would
become territorial adults. We assumed that 45% of surviving
non-territorial females would successfully transition to the
“territorial adult” stage, while 10% of surviving territorial adults
would lose their territories, becoming non-territorial adults.
Territorial adults are the primary reproductive stage, and produce an
average of 2.5 fledged hatchlings each year, half of which are female.
Non-territorial adults produce 1.1 new fledged hatchlings each year on
average, half of which are female. We ran a female-only matrix
population model, and we initialized the population with 800 juveniles,
150 subadults, 75 non-territorial adults and 50 territorial adults.</p>
</blockquote>
<p>For more on matrix population models, the bible of this subject is <a
href="https://www.amazon.com/gp/huc/view.html?ie=UTF8&amp;newItems=C1DH1414B1C6AK%2C1">this
book by Hal Caswell</a>.</p>
<p>And finally, check this out- this is a database of thousands of stage
matrices for plants and animals around the world:</p>
<p><a href="https://compadre-db.org/Data">COMADRE and COMPADRE
databases</a></p>
<p><a href="LECTURE8.html">–go to next lecture–</a></p>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
