<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 421/621" />


<title>PVA Short Course, lecture #1</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Robert Malthus (Limits to growth)</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation (Logistic growth)</a>
    </li>
    <li>
      <a href="LECTURE5.html">Positive density dependence (Allee effect)</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE12.html">Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">PVA Short Course, lecture #1</h1>
<h4 class="author">NRES 421/621</h4>
<h4 class="date">Spring 2023</h4>

</div>


<div id="population-viability-analysis-pva" class="section level2">
<h2>Population Viability Analysis (PVA)</h2>
<p>In this short course, we will explore the use of <strong>population
models</strong> to address conservation questions– a process often
called <strong>population viability analysis (PVA)</strong></p>
<p>PVA is a set of practical approaches to problem-solving in
conservation and wildlife management via creative application of
<em>population ecology theory</em>, <em>simulation models</em> and
<em>statistics</em>.</p>
<p>We will use <a href="https://insightmaker.com/">InsightMaker- a free
web-based systems modeling tool</a> for running hands-on simulation
models.</p>
<p>First we will run through the basics of population modeling for
wildlife conservation…</p>
<p>Second, we will run through a case study of the use of population
models to support the conservation and management of the Rufa Red Knot
(<em>Calidris canutus rufa</em>) and the Horseshoe Crab (<em>Limulus
polyphemus</em>), whose eggs provide a key source of food for migrating
Red Knots.</p>
<p>Let’s review some basic population ecology theory and mathematics
which are the foundation of PVA!</p>
</div>
<div id="what-is-a-population" class="section level2">
<h2>What is a population?</h2>
<p>From Charles Krebs (1972):</p>
<blockquote>
<p>“A group of organisms of the same species occupying a particular
space at a particular time, with the potential to breed with each
other”</p>
</blockquote>
<p><em>Defining a population is not always straightforward…</em>.
Spatial boundaries defining populations sometimes are easily defined,
but other times are vague and difficult to determine. Where does one
population begin and another one end?</p>
</div>
<div id="how-do-populations-change-over-time" class="section level2">
<h2>How do populations change over time?</h2>
<div
id="exponential-growth-the-fundamental-principle-of-population-ecology"
class="section level3">
<h3>Exponential growth: the fundamental principle of population
ecology</h3>
<p>Populations of living things have the ability to grow
<em>exponentially</em>. This is the “power of life”.</p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p><img src="Human_population_growth_from_1800_to_2000.png"
style="width:30.0%" /></p>
<p><img src="positivefeedback1.png" style="width:30.0%" /></p>
<p>The takeaway? With sufficient resources (e.g., plenty of food,
shelter, nest sites, etc.), populations grow in a <strong>positive
feedback</strong> loop. More individuals in the population means greater
potential for population growth (e.g., making more babies!), which means
more individuals enter the population, which means EVEN GREATER
potential for population growth.</p>
</div>
</div>
<div id="modeling" class="section level2">
<h2>Modeling!!</h2>
<div id="systems-thinking" class="section level3">
<h3>Systems thinking</h3>
<p>Modern computers have reduced or eliminated many of the barriers to
understanding how complex systems behave, and as a result
<strong>specialized software and computer programming</strong> are a
critical component to modern ecosystem studies and conservation biology,
which deal with understanding complex systems.</p>
<p>Armed with basic facility with computer programming, ecologists and
natural resource professionals can <em>formalize their
understanding</em> of the natural systems in which they work, building
models that account for complex ecological realities.</p>
<p>In addition, we can run experiments, or <strong>scenario
tests</strong> using these models, asking questions that wouldn’t
otherwise be addressable through science. <strong>In this short-course,
we will use computer simulations for understanding and performing
scenario tests with natural populations</strong>.</p>
</div>
<div
id="insightmaker-a-simulation-modeling-framework-for-dynamic-systems"
class="section level3">
<h3><em>InsightMaker</em>: a simulation modeling framework for dynamic
systems!</h3>
<p><a href="insightmaker.com">InsightMaker</a> is a web-based visual
programming language for modeling the dynamics of inter-connected
systems.</p>
<p>Any <strong>dynamic system</strong> (like a wildlife population)
essentially consists of [Stocks] and [Flows].</p>
<p>A [Stock] simply represents a quantity of something. The [Stock]
changes over time ONLY via [Flows In] or [Flows Out].</p>
<p>A [Stock] of stuff increases over time via what [Flows] in. Imagine
our stock represents <em>Moose</em>!</p>
<p><em>Moose Births</em> would then be the input [Flow] to the
population of <em>Moose</em> over time.</p>
<p>A [Stock] of stuff decreases over time via what [Flows] out. For
example, <em>Moose Deaths</em> could represent the [Flow] out of the
population of <em>Moose</em>.</p>
<p><img src="IM13.jpg" /></p>
<p>If the [Flow] into the stock is larger than the [Flow] out of the
stock, then the [Stock] increases over time.</p>
<p>If the [Flow] out is larger than the [Flow] in, then the [Stock]
decreases over time.</p>
<p>If the [Flow] in equals the [Flow] out then the amount in the [Stock]
will not change over time. In this case, the system is in
<strong>equilibrium</strong>.</p>
</div>
</div>
<div id="a-basic-simulation-model" class="section level2">
<h2>A basic simulation model</h2>
<p>It is often stated that “all models are wrong, some are useful”
(attributed to statistician George Box).</p>
<p>This demonstration model is wrong, and not super useful! But it’s a
start!</p>
<div id="simple-stock-and-flow-model" class="section level3">
<h3>Simple stock and flow model!</h3>
<ol style="list-style-type: decimal">
<li><p>Open up <a href="https://insightmaker.com/">InsightMaker</a>. If
you have never used it before you need to sign up first with a username
and password. <em>InsightMaker is free!</em></p></li>
<li><p>Click on <a
href="https://insightmaker.com/insight/162300/NRES-421-In-Class-Demo-1">this
link</a> to load up the first population modeling demo.</p></li>
<li><p>In the upper right-hand corner of the screen, click on the “Clone
Insight” link at the top and click on the “Clone” button on the
following screen (so you can make edits to this model!). If you want,
you can change the name of the model by clicking on the white space
anywhere in the workspace and then clicking the “Edit Info” button on
the left-hand context menu.</p></li>
<li><p>Now click <strong>Run Simulation</strong>. You have run your
first population simulation!</p></li>
</ol>
<p><strong>Q</strong>: What is the first thing you would like to change
to make the model more realistic?</p>
</div>
</div>
<div id="a-more-realistic-model-exponential-growth"
class="section level2">
<h2>A more realistic model: exponential growth!</h2>
<p>Now let’s assume that <em>per-capita</em> birth and death rates in
the population are constant across time. This way, if the population is
bigger, more individuals will be added to the population – a positive
feedback!</p>
<ol style="list-style-type: decimal">
<li><p>Click on <a
href="https://insightmaker.com/insight/162299/NRES-421-In-Class-Demo-2">this
link</a> to load up the next population modeling demonstration.</p></li>
<li><p>In the upper right-hand corner of the screen, click on the “Clone
Insight” link at the top and click on the “Clone” button on the
following screen (so you can make edits to this model!). If you want,
you can change the name of the model by clicking on the whitespace
anywhere in your InsightMaker workspace and then clicking the “Edit
Info” button on the left-hand context menu.</p></li>
</ol>
<p>Your model should look something like this:</p>
<p><img src="IM14.jpg" /></p>
<ol start="3" style="list-style-type: decimal">
<li><p>Click on the two [Flows] (Births and Deaths) and note the
equation displayed on the right-hand menu. Do these equations make
sense?</p></li>
<li><p>Make sure the initial number of moose is set to 50, the birth
rate is set to 0.5, and the death rate is set to 0.4. Now click [Run
Simulation]. How would you describe the results?</p></li>
</ol>
<p><strong>Q</strong>: what happens if you set the birth rate equal to
the death rate?</p>
<p><strong>Q</strong>: what happens if you set the birth rate less than
the death rate?</p>
<p>One of the most fundamental quantities in population ecology is
called the “intrinsic rate of growth”, or <em>r</em>. R is simply the
difference between birth and death rate:</p>
<p><span class="math inline">\(r=birth\ rate-death\ rate\)</span></p>
<p><strong>Q</strong>: What is the intrinsic rate of growth for this
population (when birth rate is set to 0.5 and the death rate is set to
0.4)?</p>
<p><strong>Q</strong>: What is the next thing you would like to change
to make the model more realistic?</p>
</div>
<div id="an-even-more-realistic-model" class="section level2">
<h2>An even more realistic model!!</h2>
<p>Which one of these figures is most likely to be from a real wildlife
population??</p>
<p><img src="fluct1.jpg" /></p>
<p>OR</p>
<p><img src="nofluct1.jpg" /></p>
<div id="wildlife-populations-fluctuate-over-time"
class="section level3">
<h3>Wildlife populations fluctuate over time!</h3>
<p>… And these fluctuations are often difficult to predict!</p>
<p>That is to say…</p>
</div>
<div id="the-future-is-uncertain" class="section level3">
<h3>The future is uncertain!</h3>
<p>All ecological systems are full of uncertainty. We all know it
intuitively. But what <em>exactly</em> do we mean by that? And how can
we deal with it? How can we incorporate it into our models?</p>
<p><strong>Q</strong>: if you were to re-run the basic population model
you just made in InsightMaker ten times, how many different results
would you get?</p>
<p>When a model outcome is the same every time (when starting with the
same input values) we say that the model is
<strong>deterministic</strong>.</p>
<p>BUT… ecological systems (e.g., dynamic populations) have inherent
variability.</p>
<p>We can’t predict with certainty whether or not an individual will
mate, or die.</p>
<p>We can’t be certain whether next year or the year after that will be
a good year or a bad year for offspring production or mortality!</p>
<p>The key is to <strong>embrace uncertainty</strong>. As population
ecologists, we have some tricks to help us manage and account for
unpredictable variation in our study systems:</p>
<p><img src="dice1.png" style="width:20.0%" /></p>
</div>
<div id="how-to-model-uncertainty" class="section level3">
<h3>How to model uncertainty</h3>
<p>Typically, we ‘embrace uncertainty’ in our models by incorporating
<strong>random-number generators</strong>. These types of simulation
models are called <strong>stochastic models</strong>.</p>
<p>When we incorporate random processes into models, the result will be
different each time we run the model!</p>
<p>When we use stochastic models, we often want to run lots of
<strong>replicates</strong>. Each replicate represents a possible
future.</p>
<p>We can then interpret the <em>cloud of possible futures</em> rather
than just the results from a single model run!</p>
<p><img src="IM15.jpg" /></p>
<p>Here we see that the population went extinct three times out of a
total of 50 replicates.</p>
</div>
</div>
<div id="random-number-generation" class="section level2">
<h2>Random number generation</h2>
<p>To ensure that each model run (replicate) – or each year of each
model run – is different from one another, we need to include at least
one <strong>random number generator</strong> in our models!</p>
<p>A random number generator is like a box of (potentially infinite)
possible numbers – a lottery ball machine for example! Each time we want
a new number we reach in and pull one out randomly, record the number,
put it back in and shake it up again.</p>
<p><img src="lottery1.png" style="width:20.0%" /></p>
<div id="return-to-insightmaker--add-randomness" class="section level3">
<h3>Return to InsightMaker- add randomness!</h3>
<p>The term <strong>stochasticity</strong> just means randomness. A
<strong>stochastic population model</strong> is a model with one or more
random number generators included!</p>
<ol style="list-style-type: decimal">
<li><p>Click on <a
href="https://insightmaker.com/insight/162301/NRES-421-In-Class-Demo-3">this
link</a> to load up the next population modeling demonstration.</p></li>
<li><p>In the upper right-hand corner of the screen, click on the “Clone
Insight” link at the top and click on the “Clone” button on the
following screen (so you can make edits to this model!). If you want,
you can change the name of the model by clicking on the whitespace
anywhere in your InsightMaker workspace and then clicking the “Edit
Info” button on the left-hand context menu.</p></li>
<li><p>Make sure the <em>Birth rate</em> is set to 0.5 and <em>Death
rate</em> is set to 0.4. Set initial abundance to 10. Under the
“Settings” menu make sure the model is set to run for 20 years.</p></li>
<li><p>Run the simulation. What does it look like?</p></li>
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper
right corner) to run the model 100 times. Choose your [Population]
(Moose) as the “Monitored Primitive”. View the results!</p></li>
</ol>
<p>Now, please change the initial abundance to 500 and re-run the
“Sensitivity Testing” tool.</p>
<p><strong>Q</strong>: what key differences do you notice when you
initialize the population with 10 individuals vs 500 individuals??</p>
</div>
</div>
<div id="case-study-red-knots-and-horseshoe-crabs"
class="section level2">
<h2>Case study: Red Knots and Horseshoe Crabs</h2>
</div>
<div id="and-finally-some-optional-extra-materials"
class="section level2">
<h2>And finally, some optional extra materials!</h2>
<div id="add-environmental-stochasticity" class="section level3">
<h3>Add <em>Environmental Stochasticity</em></h3>
<p><strong>Environmental stochasticity</strong> refers to the fact that
we can’t predict whether next year or the year after will be a “good
year” (high per-capita birth rates, low percent death rate) or a “bad
year”. Since we can’t predict this with certainty, we use random number
generators to make stochastic predictions and we run multiple replicates
of our model to better understand the range of possible futures given
our uncertainty.</p>
<ol style="list-style-type: decimal">
<li><p>Click on <a
href="https://insightmaker.com/insight/162298/NRES-421-In-Class-Demo-4">this
link</a> to load up the next population modeling demonstration.</p></li>
<li><p>In the upper right-hand corner of the screen, click on the “Clone
Insight” link at the top and click on the “Clone” button on the
following screen (so you can make edits to this model!). If you want,
you can change the name of the model by clicking on the whitespace
anywhere in your InsightMaker workspace and then clicking the “Edit
Info” button on the left-hand context menu.</p></li>
<li><p>Set initial abundance to 10. Under the “Settings” menu set the
model to run for 20 years.</p></li>
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper
right corner) to run the model multiple times. Choose [Population] as
the “Monitored Primitive”.</p></li>
<li><p>Change the initial abundance to 500 and re-run the “Sensitivity
Testing” tool.</p></li>
</ol>
</div>
<div id="aside-mathematics-and-modeling-in-ecology"
class="section level3">
<h3>Aside: Mathematics and modeling in Ecology</h3>
<p><img src="1976_Elton.jpg" /></p>
<p>“Like most mathematicians, he takes the hopeful biologist to the edge
of the pond, points out that a good swim will help his work, and then
pushes him in and leaves him to drown”<br />
- Charles Elton (referring to a work by Alfred Lotka)</p>
<p>“The importance of the method is this: if we know certain variables,
mostly desired by ecologists and in some cases already determined by
them, we can predict certain results which would not normally be
predictable or even expected by ecologists. The stage of verification of
these mathematical predictions has hardly begun; but their importance
cannot be under-estimated.”<br />
- Charles Elton (also referring to a work by Alfred Lotka)</p>
</div>
</div>
<div id="nomenclature-for-population-ecology" class="section level2">
<h2>Nomenclature for Population Ecology</h2>
<p>First of all, <span class="math inline">\(N\)</span> represents
population size, or <em>abundance</em>.</p>
<p><span class="math inline">\(\Delta N\)</span> represents the change
in population size, <span
class="math inline">\({N_{t+1}}-{N_t}\)</span></p>
<p>The famous “BIDE” equation is a way to break down <span
class="math inline">\(\Delta N\)</span> into components.</p>
<p><img src="IM12.jpg" /></p>
<p><span class="math inline">\(\Delta N = B + I - D - E \qquad
\text{(Eq. 1)}\)</span></p>
<p>where <span class="math inline">\(B\)</span> represents the total
number of births per time period, <span class="math inline">\(I\)</span>
reprents the number of immigrants, <span
class="math inline">\(D\)</span> represents the number of deaths, and
<span class="math inline">\(E\)</span> represents the number of
emigrants.</p>
<p>If we ignore immigration and emigration, then the BIDE equation
simplifies to:</p>
<p><span class="math inline">\(\Delta N = B - D \qquad \text{(Eq.
2)}\)</span> (the “buh-duh” equation?)</p>
<p>Now let’s focus on <span class="math inline">\(B\)</span> and <span
class="math inline">\(D\)</span>. The important thing to recognize is
that the total number of births and deaths (B and D) in a population is
not constant – they both depend on the population size!</p>
<p>What about the <strong>per capita rates</strong> of births and deaths
in a population? Is this more likely to be constant across a range of
population sizes?</p>
<p>These per capita rates are often expressed as lower case letters. So
<span class="math inline">\(b\)</span> (little b) represents per capita
births, and <span class="math inline">\(d\)</span> (little d) represents
per capita deaths.</p>
<p><span class="math inline">\(b = \frac {B_t}{N_t} \qquad \text{(Eq.
3)}\)</span></p>
<p>–or–</p>
<p><span class="math inline">\(B_t = b \cdot N_t\)</span></p>
<p>The letter <span class="math inline">\(t\)</span> of course
represents time, which ofen denotes years.</p>
<p>In plain English, the above equation could be described as follows:
“the number of births at a given time is equal to the per-capita birth
rate times the total population size at that time”. (literally, <em>per
capita</em> means “by heads” in Latin. So we multiply the birth rate
“per head” by the total number of heads!).</p>
<p>Similarly,</p>
<p><span class="math inline">\(D_t = d \cdot N_t \qquad \text{(Eq.
4)}\)</span></p>
<p>If <span class="math inline">\(\Delta N = B - D \qquad \text{(Eq.
5)}\)</span></p>
<p>then</p>
<p><span class="math inline">\(\Delta N = b \cdot N_t - d \cdot
N_t\qquad \text{(Eq. 6)}\)</span></p>
<p>which is equal to</p>
<p><span class="math inline">\(\Delta N = (b - d) \cdot N_t \qquad
\text{(Eq. 7)}\)</span></p>
<p>which could also be written:</p>
<p><span class="math inline">\(\Delta N = r \cdot N_t\qquad \text{(Eq.
8)}\)</span></p>
<p>Where <span class="math inline">\(r\)</span> represents the
difference between births and deaths. If <span
class="math inline">\(r\)</span> is positive, then births are greater
than deaths and the population grows. If <span
class="math inline">\(r\)</span> is negative then deaths exceed births
and the population declines.</p>
</div>
<div id="discrete-population-growth-most-pvas" class="section level2">
<h2>Discrete population growth (most PVAs)</h2>
<p>Most PVAs represent <em>discrete population growth</em> models, where
population growth occurs at regular intervals (often modeled as one
growth event per year): for a growing population, the population size is
constant until the next year, at which point it grows in one leap.</p>
<p><strong>Q</strong>: What wild populations exhibit discrete population
growth?</p>
<p>The greek symbol lambda (<span
class="math inline">\(\lambda\)</span>), represents the <em>finite rate
of growth</em> for a discrete population growth model, or <span
class="math inline">\(\frac {N_{t+1}}{N_t}\)</span>. Lambda is what you
multiply the current population size by to compute the population size
in the next time step.</p>
<p><span class="math inline">\(N_{t+1}=N_t + \Delta N_t \qquad
\text{(Eq. 9)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t + r_d \cdot N_t \qquad
\text{(Eq. 10)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=N_t \cdot (1 + r_d) \qquad
\text{(Eq. 11)}\)</span></p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t \qquad
\text{(Eq. 12)}\)</span></p>
<p><span class="math inline">\(N_{t}=\lambda^{t} \cdot N_0 \qquad
\text{(Eq. 13)}\)</span></p>
<p><strong>Q</strong>: Why do most population models ignore males??</p>
<div id="continuous-population-growth" class="section level3">
<h3>Continuous population growth</h3>
<p>Most PVA models involve discrete population growth (growth occurrs at
discrete points in time, e.g., once each year).</p>
<p>In a <em>continuous population growth</em> model, the population is
constantly changing: for a growing population, no matter how small the
time interval, the population will be bigger at the next time step.</p>
<p><strong>Q</strong>: What wild populations exhibit continuous
growth?</p>
<p>We can use <em>calculus notation</em> to consider the instantaneous
change in population size:</p>
<p><span class="math inline">\(\frac{\partial N}{\partial t} = r \cdot N
\qquad \text{(Eq. 9)}\)</span></p>
<p>This simple formula represents <strong>continuous exponential
growth</strong>.</p>
<p>To estimate the abundance at time <em>t</em>, we can
<em>integrate</em> this differential equation, and we get the following
result:</p>
<p><span class="math inline">\(N_t = N_0 e^{rt} \qquad \text{(Eq.
10)}\)</span></p>
</div>
<div id="getting-started-with-insightmaker" class="section level3">
<h3>Getting started with InsightMaker</h3>
<div
id="here-are-instructions-for-constructing-the-first-insightmaker-model-from-todays-lecture"
class="section level4">
<h4>Here are instructions for constructing the first InsightMaker model
from today’s lecture</h4>
<ol style="list-style-type: decimal">
<li><p>Open up <a href="https://insightmaker.com/">InsightMaker</a>. If
you have never used it before you need to sign up first with a username
and password. <em>InsightMaker is free!</em></p></li>
<li><p>Create a new “Insight” and clear the demo module.</p></li>
<li><p>Right click in the center of the screen and select <strong>Create
Stock</strong> from the pop-up. Notice that the name is <em>New
Stock</em> and is selected. Type in a name for what this is an
accumulation of (e.g., “Moose”!). Note the <strong>Configuration
Panel</strong> on the right - where you can alter the settings for your
[Stock]. In the configuration panel, set the <em>Initial Value</em> to
50. That is, there will be 50 moose at the start of the
simulation!</p></li>
<li><p>Select [Flow] in the upper left corner of your screen under
[Connections]. Now notice that when you mouse over the [Stock] a small
right-arrow displays. Click on the right-arrow and drag a couple inches
to the left of the [Stock] and release. This is how you create a [Flow]
out of a [Stock]. To create a [Flow] into a [Stock] click the
<strong>Reverse</strong> button in the <strong>Connections</strong>
menu. Please do that now. You can name the [Flow] “Births”. Also in the
<strong>Configuration Panel</strong> set <strong>Flow Rate</strong>
equal to 1.</p></li>
<li><p>Now click <strong>Run Simulation</strong> and you have just
finished your first simulation model!!</p></li>
<li><p>Can you figure out how to change the settings to run the model
for 50 years? Try this and click <strong>Run
Simulation</strong>.</p></li>
<li><p>Use the same methods as <em>step 4</em> to create a [Flow Out],
representing moose deaths. Set the death rate to 1 moose per year.
Re-run the model. Is the population increasing or declining?
Why?</p></li>
</ol>
</div>
<div id="and-the-second-model-basic-exponential-growth"
class="section level4">
<h4>And the second model (basic exponential growth)</h4>
<ol start="8" style="list-style-type: decimal">
<li><p>To create variables to store per-capita vital rates (per-capita
birth and death rates), right-click on the canvas and select
<strong>Variable</strong> from the drop-down. While the [Variable] is
still selected rename it (per-capita) <em>birth rate</em>. Open the
[Equation] window for <em>birth rate</em> and set it to 0.5 (if you
mouse over <em>Stock</em> or <em>Flow</em> a small [<span
class="math inline">\(=\)</span> Sign] will appear. If you click this it
will open the <strong>Equation</strong> window where you can set values
or enter more complex equations.</p></li>
<li><p>Now draw a [Link] from <em>birth rate</em> to the “Births”
[Flow]. In InsightMaker, flow of information is represented by a [Link].
To create a [Link], click <strong>Link</strong> in the
<strong>Connections</strong> part of the toolbar. When you mouse over
the <em>birth rate</em> click on the right-arrow, drag to the [Flow] and
release. You now have a [Link] on top of the [Flow]. Now hold the Shift
Key and click in the middle of the [Link] and a little little green node
will be created on the [Link]. You can select this node and drag it to
make a visually pleasing curved line!</p></li>
<li><p>Repeat step 10 for the the <em>death rate</em> variable.</p></li>
</ol>
<p>Your model should look something like this:</p>
<p><img src="IM14.jpg" /></p>
<ol start="11" style="list-style-type: decimal">
<li>Open the <em>Equation editor window</em> for the [Flow] and set it
to [Moose] times [birth rate]. To make sure you don’t make any typing
errors, it’s best to add variables to your equation by clicking on the
variable names in the right-hand panel of the equation editor. The
equation in the equation editor window should look like this:</li>
</ol>
<pre><code>[Moose]*[Birth rate]</code></pre>
<p>That is, the rate of inflow into the [Moose] stock is equal to the
total number of moose multiplied by the per-capita birth rate.</p>
<p>Do the same for the outflow into the [Moose] stock (Deaths).</p>
<ol start="12" style="list-style-type: decimal">
<li>Make sure the number of moose is set to 50, the birth rate is set to
0.5, and the death rate is set to 0.4. Now click [Run Simulation]. How
would you describe the results?</li>
</ol>
<p>Every random-number generator has a <strong>distribution</strong>.
This is a way of defining what exactly is in the box.</p>
<p>For example, the box might have 10 “ones”, 5 “twos”, and 2 “threes”.
In this case the distribution looks like this (<em>probability</em> of
each <em>possibility</em>):</p>
<pre class="r"><code>box &lt;- c(rep(1,10),rep(2,5),rep(3,2))
barplot(table(box)/sum(table(box)),ylab=&quot;probability&quot;,xlab=&quot;possibility&quot;)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>A probability distribution can be pretty much anything you want it to
be. However, there are several key families of distributions that come
up again and again in modeling (and in nature), and are often major
building blocks of PVA!</p>
<p>These distributions are: the <strong>binomial distribution</strong>
for modeling the total number of deaths, the <strong>Poisson
distribution</strong> for modeling the total number of births, and the
<strong>Normal distribution</strong> for modeling variation in
per-capita vital rates (e.g., percent death rate).</p>
</div>
<div id="binomial-random-number-generator-for-modeling-total-deaths"
class="section level4">
<h4>Binomial random number generator (for modeling total deaths)</h4>
<p>Imagine you flip a coin 10 times and count up the number of heads.
Then you repeat this “experiment” over and over again. Your results
should follow a <em>binomial distribution</em>!</p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="poisson-random-number-generator-for-modeling-total-births"
class="section level4">
<h4>Poisson random number generator (for modeling total births)</h4>
<p>Another discrete distribution we will use in this PVA short-course is
the *Poisson distribution. This distribution has a lower bound of 0 and
an upper bound of <span class="math inline">\(\infty\)</span>, and is
great for modeling the total number of new individuals entering a
population each year (births).</p>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="normal-distribution-variability-in-per-capita-vital-rates"
class="section level4">
<h4>Normal distribution (variability in per-capita vital rates)</h4>
<p>You are probably already familiar with the <em>Normal
distribution</em>. This distribution has a lower bound of <span
class="math inline">\(-\infty\)</span> and an upper bound of <span
class="math inline">\(\infty\)</span>. This distribution is great for
modeling variation in per-capita vital rates (e.g., death rate or birth
rate). For example, a population might have a mean per-capita birth rate
of 7.1 hatchlings per female, but in good years (lots of food resources,
low numbers of parasites, etc) the population birth rate might be as
high as 11 and in bad years it might be as low as around 3.</p>
<pre class="r"><code>mean = 7.1
stdev = 2.1

curve(dnorm(x,mean,stdev),0,15,ylab=&quot;Probability (density)&quot;,xlab=&quot;Per-capita birth rate&quot;,main=&quot;Normal distribution (variation in vital rates)&quot;)   # probability density</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="demographic-stochasticity" class="section level4">
<h4>Demographic stochasticity</h4>
<p>When it comes to projecting who lives and dies, who gives birth and
who doesn’t, how many females are born to each individual in the
population, we <em>just can’t know for sure</em>.</p>
<p>In other words, we can’t know whether an <em>individual</em> will be
“lucky” or “unlucky” so to speak!</p>
<p>In population ecology this is called <strong>demographic
stochasticity</strong>.</p>
</div>
<div id="environmental-stochasticity" class="section level4">
<h4>Environmental Stochasticity</h4>
<p>We usually can’t predict whether next year or the year after will be
a good one or a bad one for a <em>population</em>- that is, we don’t
know whether the per-capita vital rates (e.g., <span
class="math inline">\(b\)</span>, or <span
class="math inline">\(d\)</span>) will be more or less optimal
year-to-year</p>
<p>In other words, we can’t know whether a <em>population</em> will be
“lucky” or “unlucky” each year, so to speak!</p>
<p>In population ecology this is called <strong>environmental
stochasticity</strong>.</p>
</div>
<div id="and-the-third-model-demographic-stochasticity"
class="section level4">
<h4>And the third model (demographic stochasticity)</h4>
<ol style="list-style-type: decimal">
<li>Return to your Moose model (hopefully you saved it from last time!).
Set <em>Birth rate</em> back to 0.5 and <em>Death rate</em> back to 0.4.
Set initial abundance back to 50. Under the “Settings” menu set the
model to run for 10 years.</li>
</ol>
<p>Make sure your <em>Population</em> stock can NOT go negative (this is
a setting in the configurations panel: Allow Negatives = “No”). Hit
“Simulate”- you should see <em>exponential growth</em>!</p>
<ol start="2" style="list-style-type: decimal">
<li>We will use a <em>Binomial distribution</em> to represent the number
of mortalities. That is, we <em>flip a coin the same number of times as
there are individuals in the population</em>. If the coin comes up
heads, then the individual dies. In this case we are using a biased
coin- it only comes up heads 40% of the time! Each random draw from the
<em>Binomial distribution</em> essentially represents the number of
times heads came up (or the number of times mortality occurred).</li>
</ol>
<p>To do this in InsightMaker, open the equation window for the
<em>Deaths</em> flow, and use the following formula to define the total
number of deaths in the population each year:</p>
<pre><code>RandBinomial([Population], [Death rate])</code></pre>
<p>For the total births, <span class="math inline">\(B\)</span> we will
use the <em>Poisson</em> distribution. The Poisson distribution is often
use to represent births, because there could feasibly be more births
than there are individuals currently in the population (e.g., if all
individuals have two offspring!). This would not be possible with a
binomial distribution! That is, the maximum number of “heads” (you can
always think of binomial distributions as coin-flipping!) is the total
number of individuals, period.</p>
<p>To do this in InsightMaker, use the following formula for the
<em>Births</em> flow:</p>
<pre><code>RandPoisson([Population]*[Birth rate])</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Run the simulation. What does it look like?</p></li>
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper
right corner) to run the model 50 times. Choose [Population] as the
“Monitored Primitive”. View the results!</p></li>
<li><p>Change the initial abundance to 500 and re-run the “Sensitivity
Testing” tool.</p></li>
<li><p>Change the initial abundance to 10 and re-run the “Sensitivity
Testing” tool.</p></li>
</ol>
</div>
<div id="and-the-fourth-model-environmental-stochasticity"
class="section level4">
<h4>And the fourth model (environmental stochasticity)</h4>
<ol style="list-style-type: decimal">
<li>For now, set <em>Births</em> back to what it was before:</li>
</ol>
<pre><code>[Moose]*[Birth rate]</code></pre>
<p>And do the same for <em>Deaths</em>!</p>
<pre><code>[Moose]*[Death rate]</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We will use a <em>Normal distribution</em> to represent how the
birth rate changes each year. This could represent climatic variablity –
“good years” and “bad years”. The <em>Normal distribution</em> is
commonly used for this type of variability- it is characterized by an
average value (<strong>mean</strong>) and a variability measure
(<strong>standard deviation</strong>). To do this in InsightMaker, use
the following formula for the <em>Birth Rate</em> variable:</li>
</ol>
<pre><code>RandNormal(0.4, 0.4)</code></pre>
<p>Similarly, we could use the following formula to represent
environmental stochasticity in the <em>Death Rate</em> variable:</p>
<pre><code>RandNormal(0.3, 0.4)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><p>Use the “Sensitivity Testing” tool (in the “Tools” menu, upper
right corner) to run the model 50 times. Choose [Population] as the
“Monitored Primitive”.</p></li>
<li><p>Change the initial abundance to 500 and re-run the “Sensitivity
Testing” tool.</p></li>
</ol>
</div>
</div>
</div>
<div id="random-number-generators" class="section level2">
<h2>Random number generators</h2>
<div id="random-number-generators-for-demographic-stochasticity"
class="section level3">
<h3>Random number generators for demographic stochasticity</h3>
<div id="binomial-random-number-generator" class="section level4">
<h4>Binomial random number generator</h4>
<p>Imagine you flip a coin 10 times and count up the number of heads.
Then you repeat this “experiment” over and over again. Your results
should follow a <em>binomial distribution</em>!</p>
<pre class="r"><code>             # plot a discrete distribution!
xvals &lt;- seq(0,10,1)
probs &lt;- dbinom(xvals,10,prob=0.3)
names(probs) &lt;- xvals
               
barplot(probs,ylab=&quot;Probability&quot;,xlab=&quot;Possibilities&quot;,main=&quot;Binomial distribution (discrete)&quot;)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p><strong>Q</strong> What population parameter might this distribution
be useful for modeling?</p>
</div>
<div id="poisson-random-number-generator" class="section level4">
<h4>Poisson random number generator</h4>
<p>Another discrete distribution we will use in this PVA mini-course is
the *Poisson distribution. This distribution has a lower bound of 0 and
an upper bound of <span class="math inline">\(\infty\)</span>.</p>
<pre class="r"><code>             # plot a discrete distribution!
xvals &lt;- seq(0,10,1)
probs &lt;- dpois(xvals,lambda=2.2)
names(probs) &lt;- xvals
               
barplot(probs,ylab=&quot;Probability&quot;,xlab=&quot;Possibilities&quot;,main=&quot;Poisson distribution (discrete)&quot;)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p><strong>Q</strong> What population parameter might this distribution
be useful for modeling?</p>
</div>
</div>
<div id="random-number-generators-for-environmental-stochasticity"
class="section level3">
<h3>Random number generators for environmental stochasticity</h3>
<div id="normal-distribution" class="section level4">
<h4>Normal distribution</h4>
<p>You are probably already familiar with the <em>Normal
distribution</em>. This distribution has a lower bound of <span
class="math inline">\(-\infty\)</span> and an upper bound of <span
class="math inline">\(\infty\)</span>.</p>
<p><strong>Q</strong> What population parameter might this distribution
be useful for modeling?</p>
<pre class="r"><code>mean = 7.1
stdev = 1.9

curve(dnorm(x,mean,stdev),0,15,ylab=&quot;Probability (density)&quot;,xlab=&quot;Possibilities&quot;,main=&quot;Normal distribution (continuous)&quot;)   # probability density</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p><strong>Q</strong> What population parameter might this distribution
be useful for modeling?</p>
</div>
</div>
</div>
<div id="a-simple-demonstration-pva" class="section level2">
<h2>A Simple Demonstration PVA</h2>
<p>To illustrate what we can do with your PVA results, here is a very
simple PVA model in R.</p>
<p>For this demo I’m using the <em>“R” programming language</em> because
of its flexible and powerful visualization tools. You can download R for
yourself from <a href="https://cran.r-project.org/">this
website</a>:</p>
<p>If you want to follow along, click on the link <a
href="PVA1_421.R">here</a></p>
<p>For simplicity, let’s ignore age structure.</p>
<p>Also let’s ignore parameter uncertainty for now.</p>
<p>Here is the basic model parameterization:</p>
<pre class="r"><code>####
# Basic simulation parameters
####

nyears &lt;- 100     # number of years
nreps &lt;- 500      # number of replicates

####
# Basic life history parameters
####

R_max &lt;- 1.03       # Maximum rate of growth (max lambda)
Init_N &lt;- 51        # Initial abundance
K &lt;- 175            # Carrying capacity

####
# Environmental stochasticity
####

SD_lambda &lt;- 0.11  # standard deviation of lambda

####
# Density-dependence (Ricker model)
####

Ricker &lt;- function(prev_abund){       # this is a function for computing next-year abundance -- includes env stochasticity
  prev_abund * exp(log(rnorm(1,R_max,SD_lambda))*(1-(prev_abund/K)))
}

####
# Catastrophe
####

Flood_prob &lt;- 0.0     # 0% chance of major flood
Flood_lambda &lt;- 0.25    # 25% of population can survive a flood, should it occur!</code></pre>
<p>Now we can use these parameters to build a simple PVA model:</p>
<pre class="r"><code>## Set up data structures to store simulation results!

PVAdemo &lt;- function(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda){
  #browser()
  PopArray2 &lt;- array(0,dim=c((nyears+1),nreps))
  
  ## start looping through replicates
  
  for(rep in 1:nreps){
    
    # set initial abundance
    PopArray2[1,rep] &lt;- Init_N     # initial abundance
    
    ### loop through years
    for(y in 2:(nyears+1)){
      ### stochasticity and d-d
      nextyear &lt;- max(0,trunc(Ricker(PopArray2[y-1,rep])))
      
      ### catastrophe
      if(runif(1)&lt;Flood_prob) nextyear &lt;- nextyear*Flood_lambda
      PopArray2[y,rep] &lt;- nextyear 
    }
  }
  
  return(PopArray2)
}

### Run the PVA!

Default &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,Flood_lambda)</code></pre>
<div id="graphical-visualization" class="section level3">
<h3>Graphical visualization</h3>
<p>There are several types of visualizations that you might want to use
for your PVA models:</p>
<p>The first is to look at the “cloud” of abundance trajectories. This
is the same type of figure we have seen in InsightMaker using the
“Sensitivity testing” tool.</p>
<pre class="r"><code>PlotCloud &lt;- function(simdata){
  plot(c(1:101),simdata[,1],col=gray(0.7),type=&quot;l&quot;,ylim=c(0,max(simdata)),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;)
  
  for(r in 2:ncol(simdata)){
    lines(c(1:101),simdata[,r],col=gray(0.7),type=&quot;l&quot;)
  }
}

PlotCloud(Default)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Okay, what do we learn from this? Really, it’s a mess!!!</p>
<p>If our question is about extinction risk, maybe we want to plot
extinction risk by time…</p>
<pre class="r"><code>Extinction_byyear &lt;- function(simdata){
  apply(simdata,1,function(t)  length(which(t==0)))/ncol(simdata)
}

plot(c(1:101),Extinction_byyear(Default),type=&quot;l&quot;,lwd=2,xlab=&quot;year&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Maybe our question is about the probability of decline over 100 years
…</p>
<p>In that case maybe we should present a histogram of final
abundances…</p>
<pre class="r"><code>hist(Default[nrow(Default),],xlab=&quot;Final abundance after 100 years&quot;,ylab=&quot;Number of replicates&quot;,main=&quot;&quot;)
abline(v=Init_N,col=&quot;green&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>We could compute the probability of decline by computing <span
class="math inline">\(\frac{number.declined}{total.simulations}\)</span></p>
<pre class="r"><code>prob_decline &lt;- round(length(which(Default[nrow(Default),]&lt;Init_N))/ncol(Default),2)
cat(&quot;the probability of decline is: &quot;, prob_decline)</code></pre>
<pre><code>## the probability of decline is:  0.18</code></pre>
<p>What if our question is about the effect of flooding on extinction
risk?</p>
<p>Let’s imagine that the probability of flooding is not expected to
change with climate change, but that the intensity of the flood damage
is likely to increase substantially!</p>
<p>Currently, floods generally result in a 10% population reduction. But
climate change could increase this number to as much as 90%. Let’s look
at how much this could increase extinction risk!</p>
<pre class="r"><code>Flood_prob &lt;- 0.1     # 10% chance of major flood

Exctinction_risk &lt;- function(simdata){
  length(which(simdata[nrow(simdata),]==0))/ncol(simdata)
}

flood_lambdas &lt;- seq(0.9,0.1,by=-0.05)

all_scenarios &lt;- numeric(length(flood_lambdas))
for(scenario in 1:length(flood_lambdas)){
  PVA &lt;- PVAdemo(nreps,nyears,Init_N,R_max,K,Flood_prob,flood_lambdas[scenario])
  all_scenarios[scenario] &lt;- Exctinction_risk(PVA)
}

plot(flood_lambdas,all_scenarios,type=&quot;p&quot;,cex=2,xlab=&quot;flood impact (lambda in flood year)&quot;,ylab=&quot;extinction risk&quot;)
abline(h=0.05,col=&quot;red&quot;,lwd=2)</code></pre>
<p><img src="PVA1_421_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="population-viability-analysis-pva-1" class="section level2">
<h2>Population Viability Analysis (PVA)</h2>
<p>Let’s return to the topic of this unit: PVA.</p>
<p>Population Viability Analysis (PVA) is the <em>process of building
and running formal predictive population models for the purpose of
gaining insight about present and future conservation status, or ranking
alternative conservation actions</em>.</p>
<div id="what-are-some-questions-you-can-address-with-pva"
class="section level3">
<h3>What are some questions you can address with PVA?</h3>
<p>In general, we are interested in evaluating population-level risk
under various alternative <strong>scenarios</strong>. These scenarios
could involve alternative initial population sizes, alternative vital
rates (e.g., survival rates), or alternative management actions.</p>
<p>Setting up alternative scenarios is a bit like setting up experiments
in a laboratory!</p>
<p>We are often interested in evaluating the factors that threaten the
present or future viability of a population.</p>
<p>Population threats can be classified as either deterministic or
stochastic.</p>
</div>
<div id="deterministic-threats" class="section level3">
<h3>Deterministic threats</h3>
<p><img src="Fragmentation1.jpg" /> <img src="harvest1.jpg" /></p>
<p>Given what we know (and what we don’t know!) about our study system,
what is the population-level impact of:</p>
<ul>
<li>Habitat fragmentation?</li>
<li>Habitat degradation or loss?</li>
<li>Direct Harvest?</li>
<li>Exotic invasive species?</li>
<li>Environmental toxins?</li>
</ul>
</div>
<div id="stochastic-threats" class="section level3">
<h3>Stochastic threats</h3>
<p>Given what we know (and what we don’t know!) about our study system,
what is the population-level impact of:</p>
<ul>
<li>Demographic stochasticity?</li>
<li>Environmental stochasticity?</li>
<li>Catastrophes?</li>
<li>Loss of genetic diversity?</li>
</ul>
<p><strong>Q</strong>: which is more likely to cause a large population
to become small: stochastic threats or deterministic threats?</p>
<p><strong>Q</strong>: can you match the above concepts with the two
“paradigms” of conservation biology (from Caughley 1994): the
<em>small-population paradigm</em> and the <em>declining-population
paradigm</em>?</p>
</div>
</div>
<div id="a-general-pva-workflow" class="section level2">
<h2>A general PVA workflow</h2>
<p><img src="PVAschematic1.png" /></p>
<div id="step-0-define-your-questionshypotheses" class="section level3">
<h3>Step 0: Define your questions/hypotheses</h3>
</div>
<div id="step-1-life-history" class="section level3">
<h3>Step 1: Life history</h3>
<p><em>How does your population work?</em></p>
<p>The first step (after you have formulated your research questions, of
course!) is to conceptualize the key life history traits that you need
to know to address your main questions. In general, the following life
history traits are often critical to consider:</p>
<ul>
<li>Maximum and minimum reproductive age</li>
<li>Number of relevant age classes</li>
<li>Maximum population density</li>
<li>Density-dependence mechanisms</li>
<li>Variability in key vital rates</li>
</ul>
</div>
<div id="step-2-parameterize-the-demographic-model"
class="section level3">
<h3>Step 2: Parameterize the demographic model!</h3>
<p>This is where you attach <em>real numbers</em> to the stocks and
flows in your conceptual life history diagram!</p>
</div>
<div id="step-3-spatial-structure-metapopulations"
class="section level3">
<h3>Step 3: Spatial structure (metapopulations)!</h3>
<p>If you want to ask spatial questions, your model needs to be
spatially explicit. The kinds of questions you might think about
include:</p>
<ul>
<li>How many discrete populations?</li>
<li>At what rate do individuals move among these populations?</li>
</ul>
<p>For the grizzly bear and loggerhead examples, we will not consider
spatial structure!</p>
</div>
<div id="step-4-simulate-under-alternative-scenarios"
class="section level3">
<h3>Step 4: Simulate under alternative scenarios!</h3>
<p>There are lots of options for simulation software- R, <a
href="https://insightmaker.com/">InsightMaker</a>, <a
href="http://www.vortex10.org/Vortex10.aspx">Vortex</a>, <a
href="http://www.ramas.com/metapop">Ramas</a>, and much more!</p>
<p>The key question here is: what <em>scenarios</em> do you want to test
in order to answer your original questions?</p>
</div>
<div id="step-5-results" class="section level3">
<h3>Step 5: Results</h3>
<p>Finally, you need to make sense of all the simulations you just
ran!</p>
<p>There are two major tools that you will need to do this:
<strong>graphical visualization</strong> and <strong>statistical
analysis</strong>.</p>
<p>NOTE: The process of building a PVA model is
<strong>iterative</strong> and <strong>non-linear</strong>.</p>
<p>For example – after running your model (step 4) you might realize
that your results (step 5) are unrealistic. This might prompt you to go
back to the literature and change your parameter estimates to something
more realistic (step 2).</p>
<p>Okay, now let’s build a PVA model together!</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
