<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="NRES 470/670" />


<title>Lab 4: Matrix population models</title>

<script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/spacelab.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">NRES 470/670</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="INTRO.html">Introduction to NRES 470</a>
    </li>
    <li>
      <a href="LECTURE1.html">A whole-systems approach to population ecology</a>
    </li>
    <li>
      <a href="LECTURE2.html">Introduction to population ecology</a>
    </li>
    <li>
      <a href="LECTURE3.html">Thomas Robert Malthus</a>
    </li>
    <li>
      <a href="LECTURE4.html">Population Regulation</a>
    </li>
    <li>
      <a href="LECTURE5.html">Passenger Pigeon</a>
    </li>
    <li>
      <a href="LECTURE6.html">Age-structured populations</a>
    </li>
    <li>
      <a href="LECTURE7.html">Matrix population models</a>
    </li>
    <li>
      <a href="LECTURE8.html">Stochastic population models</a>
    </li>
    <li>
      <a href="LECTURE9.html">Small population paradigm</a>
    </li>
    <li>
      <a href="LECTURE10.html">Individual-based models</a>
    </li>
    <li>
      <a href="LECTURE11.html">Declining population paradigm</a>
    </li>
    <li>
      <a href="LECTURE12.html">Population Viability Analysis</a>
    </li>
    <li>
      <a href="LECTURE13.html">Metapopulations</a>
    </li>
    <li>
      <a href="LECTURE14.html">PVA example: pdogs and ferrets</a>
    </li>
    <li>
      <a href="LECTURE15.html">Parameter estimation</a>
    </li>
    <li>
      <a href="LECTURE16.html">Species interactions: competition</a>
    </li>
    <li>
      <a href="LECTURE17.html">Species interactions: prey-predator</a>
    </li>
    <li>
      <a href="LECTURE18.html">Wrap-up</a>
    </li>
    <li>
      <a href="PVA1_421.html">NRES421: PVA basics</a>
    </li>
    <li>
      <a href="PVA2_421.html">NRES421: grizzly PVA</a>
    </li>
    <li>
      <a href="PVA3_421.html">NRES421: loggerhead PVA</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="LAB1.html">Lab 1: exponential growth</a>
    </li>
    <li>
      <a href="LAB2.html">Lab 2: logistic growth</a>
    </li>
    <li>
      <a href="LAB3.html">Lab 3: age-structured population growth</a>
    </li>
    <li>
      <a href="LAB4.html">Lab 4: matrix population models</a>
    </li>
    <li>
      <a href="LAB5.html">Lab 5: stochasticity and uncertainty</a>
    </li>
    <li>
      <a href="LAB6.html">Lab 6: metapopulations</a>
    </li>
    <li>
      <a href="LAB7.html">Lab 7: capture-mark-recapture</a>
    </li>
    <li>
      <a href="FINAL_PROJECTS.html">Final Projects!</a>
    </li>
    <li>
      <a href="EXTRA_CREDIT.html">Extra Credit!</a>
    </li>
  </ul>
</li>
<li>
  <a href="Links.html">Links</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab 4: Matrix population models</h1>
<h4 class="author">NRES 470/670</h4>
<h4 class="date">Spring 2022</h4>

</div>


<p>In this lab we will continue to work with age-structured populations: specifically, we will get familiar with <strong>matrix projection models</strong>! Remember that while matrix population models may look complicated, they are just a fancy, age/stage structured version of basic discrete exponential growth (<span class="math inline">\(N_{t+1}=\lambda \cdot N_t\)</span>)!</p>
<div id="mathematics-of-matrix-population-models" class="section level2">
<h2>Mathematics of matrix population models:</h2>
<p>We all remember the finite-population-growth equation:</p>
<p><span class="math inline">\(N_{t+1}=\lambda \cdot N_t \qquad \text{(Eq. 1)}\)</span>,</p>
<p>where <span class="math inline">\(N\)</span> is abundance (as always), <span class="math inline">\(t\)</span> is time, often in years but could be any time units, and <span class="math inline">\(\lambda\)</span> is the multiplicative growth rate over the time period <span class="math inline">\(t \rightarrow t+1\)</span></p>
<p>In other words, <span class="math inline">\(\lambda\)</span> is the population multiplier per time step. You want next year’s expected abundance? Just multiply last year’s abundance by <span class="math inline">\(\lambda\)</span>!</p>
<p>The matrix population growth equation looks pretty much the same!</p>
<p><span class="math inline">\(\mathbf{N}_{t+1} = \mathbf{A} \cdot \mathbf{N}_{t} \qquad \text{(Eq. 2)}\)</span>,</p>
<p>where <span class="math inline">\(\mathbf{N}\)</span> is a <strong>vector</strong> of abundances (abundance for all stages), and <span class="math inline">\(\mathbf{A}\)</span> is the <strong>transition matrix</strong>, which we have seen before.</p>
<p>We can be more explicit about this if we re-write the above equation this way:</p>
<p><span class="math inline">\(\begin{bmatrix}N_1\\ N_2\\N_3 \end{bmatrix}_{t+1}=\begin{bmatrix}F_1 &amp; F_2 &amp; F_3\\ P_{1 \rightarrow 2} &amp; P_{2 \rightarrow 2} &amp; 0\\ 0 &amp; P_{2 \rightarrow 3} &amp; P_{3 \rightarrow 3}\end{bmatrix} \cdot \begin{bmatrix}N_1\\ N_2\\N_3 \end{bmatrix}_{t} \qquad \text{(Eq. 3)}\)</span></p>
<p>Where <span class="math inline">\(P_{1 \rightarrow 2}\)</span> is the probability of advancing from stage 1 to 2 (per capita ‘production’ of stage 2 individuals next year by stage 1 individuals this year), and <span class="math inline">\(F_2\)</span> is the <strong>fecundity</strong> of stage 2 (per-capita production of offspring next year by stage 2 individuals this year).</p>
<p>NOTE: <em>survival <em>P</em> in a stage transition matrix is NOT necessarily the same thing as survival rate</em> (e.g., g(x) from a life table). What’s the difference?</p>
<p>In a stage-based matrix model, individuals can survive in one of two ways - they can either stay in the same stage, or they can transition to the next stage. To compute total survival, you have to add up the probability of staying in the same stage and the probability of moving on to the next stage! (NOTE: in a <strong>Leslie matrix</strong>, all individuals must either transition to the next stage or die.)</p>
<p>NOTE: <em>fecundity <em>F</em> in a stage transition matrix is NOT the same thing as age-specific birth rate <em>b(x)</em></em> from a life table, <span class="math inline">\(b\)</span>. What’s the difference?</p>
<p>Birth rate <span class="math inline">\(b_t\)</span> from life tables is the per-capita rate of offspring production for age <span class="math inline">\(t\)</span> individuals (individuals that are exactly age t). We can think of this as the number of offspring produced per female at the moment they reach <span class="math inline">\(t\)</span> years of age.<br />
Fecundity, <span class="math inline">\(F_s\)</span>, is the per-capita rate by which individuals that were in stage <span class="math inline">\(s\)</span> at time <span class="math inline">\(t\)</span> contribute new offspring to the population at time <span class="math inline">\(t+1\)</span>. Sounds pretty similar, right? What’s the difference?? Well, the difference is exactly <em>one time step</em> (which is typically one year)!</p>
<p>That is, Fecundity <span class="math inline">\(F_s\)</span> also takes into account the <em>survival rate</em> to the next time step (e.g., <span class="math inline">\(P_{1 \rightarrow 2}\)</span>)!! For an adult of stage <span class="math inline">\(s\)</span> to contribute to the next generation, <em>it must first survive to the next time step</em> before it can reproduce!.</p>
<p><span class="math inline">\(F_s = P_{surv.this.year} \cdot b_{age.next.year} \qquad \text{(Eq. 4)}\)</span></p>
<div id="matrix-operations" class="section level3">
<h3>Matrix operations:</h3>
<p>There is a lot we can do with matrix population models. The most obvious one is <em>projection</em>:</p>
<div id="projection" class="section level4">
<h4>Projection:</h4>
<p>This lab demo contains a bunch of R code (R makes it pretty easy to run matrix population models!). If you want to follow along in R, you can find the R script <a href="LAB4.R">here</a>. I recommend right-clicking on the link, saving the script to a designated folder, and loading up the script in RStudio.</p>
<p>We have already seen the projection equation (Eq. 2, above). Here is how we can implement this in R:</p>
<pre class="r"><code>########
# Syntax for projecting abundance using a transition matrix (NOTE: this code won&#39;t run until we specify the terms on the right)

Year1 &lt;- projection_matrix %*% Abundance_year0  # matrix multiplication!</code></pre>
<p>Let’s try it:</p>
<p>First, build a projection matrix:</p>
<pre class="r"><code>######
# First, build a simple projection matrix

projection_matrix &lt;- matrix(
  c(
    0,     1.2,   3.1,
    0.4,   0,     0,
    0,     0.75,   0
  )
  ,nrow=3,ncol=3,byrow=T
)

projection_matrix</code></pre>
<pre><code>##      [,1] [,2] [,3]
## [1,]  0.0 1.20  3.1
## [2,]  0.4 0.00  0.0
## [3,]  0.0 0.75  0.0</code></pre>
<p>Next, let’s build an initial abundance vector:</p>
<pre class="r"><code>######
# Then we specify initial abundances for the three age classes

Abundance_year0 &lt;- c(1000,0,0)
Abundance_year0</code></pre>
<pre><code>## [1] 1000    0    0</code></pre>
<p>Now we can run the code for real!</p>
<pre class="r"><code>######
# Now we can run the code for real

Year1 &lt;- projection_matrix %*% Abundance_year0  # matrix multiplication!
Year1</code></pre>
<pre><code>##      [,1]
## [1,]    0
## [2,]  400
## [3,]    0</code></pre>
<p>Now we have 300 individuals in stage 2!</p>
<p>Let’s project one more year:</p>
<pre class="r"><code>########
# Project another year

Year2 &lt;- projection_matrix %*% Year1  # matrix multiplication!
Year2</code></pre>
<pre><code>##      [,1]
## [1,]  480
## [2,]    0
## [3,]  300</code></pre>
<p>Finally, here is some code to project many years into the future! You may want to re-use some of this code for the exercises below.</p>
<pre class="r"><code>##########
# Use a FOR loop to project many years into the future

nYears &lt;- 20                                            # set the number of years to project
TMat &lt;- projection_matrix                               # define the projection matrix
InitAbund &lt;- Abundance_year0                            # define the initial abundance

  ## NOTE: the code below can be re-used without modification:
allYears &lt;- matrix(0,nrow=nrow(TMat),ncol=nYears+1)     # build a storage array for all abundances!
allYears[,1] &lt;- InitAbund  # set the year 0 abundance                                    
for(t in 2:(nYears+1)){   # loop through all years
  allYears[,t] &lt;-  TMat %*% allYears[,t-1]
}
plot(1,1,pch=&quot;&quot;,ylim=c(0,max(allYears)),xlim=c(0,nYears+1),xlab=&quot;Years&quot;,ylab=&quot;Abundance&quot;,xaxt=&quot;n&quot;)  # set up blank plot
cols &lt;- rainbow(ncol(TMat))    # set up colors to use
for(s in 1:ncol(TMat)){
  points(allYears[s,],col=cols[s],type=&quot;l&quot;,lwd=2)     # plot out each life stage abundance, one at a time
}
axis(1,at=seq(1,nYears+1),labels = seq(0,nYears))   # label the axis
legend(&quot;topleft&quot;,col=cols,lwd=rep(2,ncol(TMat)),legend=paste(&quot;Stage &quot;,seq(1:ncol(TMat))))  # put a legend on the plot</code></pre>
<p><img src="LAB4_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="compute-lambda" class="section level4">
<h4>Compute lambda</h4>
<p>Clearly this is a growing population. But let’s see exactly what <span class="math inline">\(\lambda\)</span> is!</p>
<pre class="r"><code>############
# Use the &#39;popbio&#39; package to compute lambda (NOTE: you first have to install the popbio package! You only have to install the package once...)

library(popbio)

lambda(projection_matrix)</code></pre>
<pre><code>## [1] 1.138728</code></pre>
<p>Pretty easy right?</p>
<p>NOTE: we are using a “package” in R to make these analyses super easy! So if you don’t already have the “popbio” package, go to the “Packages” tab in Rstudio (should be at the top of the lower right panel), click on “Install”, and then type “popbio” in the “Packages” field in the pop-up window, then click on the “Install” button.</p>
<p>Or just use the following code:</p>
<pre class="r"><code>#############
# Use this code if you haven&#39;t installed &#39;popbio&#39; yet. Once you&#39;ve installed it, you can delete the line or comment this line out by adding a pound sign before the &quot;i&quot; in &quot;install.packages&quot;

install.packages(&quot;popbio&quot;)</code></pre>
</div>
<div id="compute-stable-age-distribution-s.a.d." class="section level4">
<h4>Compute stable-age distribution (S.A.D.)</h4>
<p>Clearly the population doesn’t reach a stable age distribution until a few years into our simulation. What exactly is the stable age distribution here? We can do this in R:</p>
<pre class="r"><code>###### 
# Use the &#39;popbio&#39; package to compute the stable age distribution!

stable.stage(projection_matrix)</code></pre>
<pre><code>## [1] 0.6318614 0.2219535 0.1461852</code></pre>
<p>And that is really all we need to know to get started with matrix-based population models!</p>
</div>
</div>
</div>
<div id="exercise-1-matrix-projection-models" class="section level2">
<h2>Exercise 1: matrix projection models!</h2>
<p>In this exercise, you will have a chance to play around with a very simple matrix population model. But first, you need to translate a life table into a transition matrix!</p>
<p>Here is the life table: <a href="life_table4.xlsx">Excel format</a><br />
<a href="life_table4.csv">CSV format</a></p>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">S(x)</th>
<th align="right">b(x)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">500</td>
<td align="right">0.0</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">101</td>
<td align="right">1.9</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">59</td>
<td align="right">5.8</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">31</td>
<td align="right">6.1</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">5</td>
<td align="right">2.5</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">0</td>
<td align="right">0.0</td>
</tr>
</tbody>
</table>
<p>1a. Translate the above <em>life table</em> into a five-age-class transition matrix (age class 0 to age class 4). In your written lab report, provide the full transition matrix and describe the formula used to compute the matrix element in row 1 column 3. This is a bit harder than it sounds! Also, it can be difficult to do this as a standard text entry submission, so if you would rather upload an image (e.g., a photo of your hand-drawn matrix and calculations), you can use the optional image upload in Top Hat.</p>
<p>Keep the following points in mind:</p>
<ul>
<li>Individuals are in the “age 0” stage if they are between the ages of 0 and 1. They transition to the “age 1” stage (<span class="math inline">\(P_{0 \rightarrow 1}\)</span>) if they survive to age 1 (thereby entering their second year of life).<br />
</li>
<li>For individuals of the “age 0” class to contribute new offspring to the population in the next time step (<span class="math inline">\(F_0\)</span>), they have to survive their first year of life (<span class="math inline">\(P_{0 \rightarrow 1}\)</span>) AND produce offspring when they are exactly 1 year of age (which they do at the rate of <span class="math inline">\(b(1)\)</span> – the birth rate at age 1).<br />
</li>
<li>Use five age classes for your transition matrix (age class 0 through 4). Individuals in the final age class (age class 4) have zero survival (you can’t survive to age 5) and zero fecundity (if there are no individuals left at age 5, how can they reproduce!)<br />
</li>
<li>No individual ever stays in the same age-class two time steps in a row- they either transition to the next age class or they die (this simple type of matrix model is called a <strong>Leslie Matrix</strong> model).</li>
</ul>
<p>NOTE: Gotelli uses the term ‘age class 1’ to refer to individuals in their first year of life (0-year-olds) and ‘age class 2’ for individuals in their second year of life (one-year-olds), but I think it’s easier to think of this as age class 0, age class 1, etc. That way, our age classes will match the way we usually talk about age in years!</p>
<p>1b. Use R (‘popbio’ package) to compute the finite rate of growth for the population (<span class="math inline">\(\lambda\)</span>). What is the finite rate of growth <span class="math inline">\(\lambda\)</span> for this population? Based on this result, is this a growing or declining population?</p>
<p>1c. Use R (‘popbio’ package) to compute the stable-age distribution for the population (S.A.D.). What is the stable age distribution for this population (fraction of the population in each age-class at S.A.D.)? Now imagine you have a total population size of 850. Assuming this population is at S.A.D., how many individuals are in each age-class? (NOTE: you can’t have fractional individuals, so please round to the nearest whole numbers)</p>
<p>1d. Use R to project this population for 30 years. Initialize your population with 850 individuals, and set the initial population to the stable age distribution you computed in part 1c. What is the total number of individuals in age class 3 (3-year-olds) after 15 years? What is the total abundance (sum across all age classes) after 30 years?</p>
<p>1e. Finally, run your simulation again, this time starting with all 850 individuals in age-class 0 (all newborns!). What is the final abundance after 30 years (sum across all age classes)? Is the final abundance smaller or larger than the final abundance (after 30 years) you computed in part 1d, above? Why do you think the final abundance estimate is different from the calculation you did in question 1d?</p>
</div>
<div id="exercise-2-translate-insightmaker-to-projection-matrix" class="section level2">
<h2>Exercise 2: translate InsightMaker to projection matrix!</h2>
<p>Return to the InsightMaker model you created in Lab 3 (exercise 3 – that is, a basic age structured population model, without the carrying capacity component you implemented in Exercise 4 of Lab 3). Your model should look something like this:</p>
<p><img src="IM_lab3.JPG" /></p>
<p>Make sure the parameters are at the original values specified in Exercise 3 of Lab 3 (before altering mortality rates as part of lab 3 question 3e). As a reminder, here they are again:</p>
<ul>
<li>For recruitment, set <em>Birth rate, age 1</em> at 1.3 and <em>Birth rate, age 2</em> at 1.6.<br />
</li>
<li>For transition rates, set <em>Transition rate, Age 0 to 1</em> at 0.45 and <em>Transition rate, Age 1 to 2</em> at 0.35. NOTE: these transition rates could also be called “survival rates”<br />
</li>
<li>For the mortality rates, note that all individuals in the <em>Age 0</em> stock must either transition to <em>Age 1</em> or die (mortality rates are 1 minus the corresponding transition rate). In addition, all individuals in the <em>Age 2</em> stock must die- there is no <em>Age 3</em> class!</li>
</ul>
<p>2a. Translate this InsightMaker model into a projection matrix. This shouldn’t be too difficult, but pay close attention to the difference between survival (transition to the next stage class) and mortality. Please enter your full transition matrix into TopHat. It can be difficult to do this as a standard text entry submission, so if you would rather upload an image (e.g., a photo of your hand-drawn matrix and calculations), you can use the optional image upload in Top Hat.</p>
<p>2b. Starting with 75 individuals, all in Age 0, project the population 20 years into the future, using both InsightMaker and R. <em>You don’t need to show your R code or the InsightMaker model this time</em>. Please provide two plots- one showing the results of the R simulation and the other showing the results of the InsightMaker simulation). These plots should look essentially identical!</p>
<p>Now let’s go the other way around – build an InsightMaker model based on a population matrix!</p>
<div id="use-the-following-stage-matrix-to-answer-questions-2c-d" class="section level4">
<h4>Use the following stage matrix to answer questions 2c-d</h4>
<p>Here is a stage-based matrix to use for building your InsightMaker model:</p>
<p>Click <a href="stage_matrix1.csv">here</a> to download the CSV file.<br />
Click <a href="stage_matrix1.xlsx">here</a> to download the same matrix as an Excel file.</p>
<pre class="r"><code>stmat &lt;- read.csv(&quot;stage_matrix1.csv&quot;)
stmat &lt;- as.matrix(stmat[,-1])
rownames(stmat) &lt;- colnames(stmat)
stmat</code></pre>
<pre><code>##        Stage1 Stage2 Stage3
## Stage1   0.04   0.30   0.85
## Stage2   0.38   0.15   0.00
## Stage3   0.00   0.56   0.77</code></pre>
<pre class="r"><code># lambda(stmat) </code></pre>
<p>2c. Build an InsightMaker model that represents the same population as the stage-based matrix above. Provide the URL to your InsightMaker model via top hat (and remember to clone your Insight to ensure that you don’t alter the model once you submit it).</p>
<p>2d. Use this stage matrix to project the population 20 years into the future using R, starting with 100 individuals at S.A.D. Please provide a plot of projected abundance of each stage over the 20 year simulation. Do the same in InsightMaker (project the population 20 years into the future), and make sure the population dynamics look the same in R and InsightMaker. Provide both the InsightMaker and R plots to show that the two models are identical.</p>
<p>NOTE: In this class we have stressed the importance of density dependence in determining and regulating the dynamics of real populations. Were any of the population models in this lab density-dependent? [Answer: NO!]</p>
</div>
<div id="optional-challenge" class="section level4">
<h4>Optional challenge:</h4>
<p>Build a density-dependent vital rate into your model. BUT instead of doing what we have done before (birth and death rates are density-dependent), build a model where the transition rate from one stage to the next is density dependent but stage-specific survival does not change! Here is the scenario:</p>
<blockquote>
<p>The stage matrix in this exercise is representative of a population at very low abundance (near 0). If abundance increases above the threshold of 100 individuals, no individuals can transition from stage 2 to stage 3 (grow to full maturity)- however, overall survival rates and stage-specific fecundity rates remain unchanged.</p>
</blockquote>
</div>
</div>
<div id="exercise-3.-translate-written-population-description-to-projection-matrix" class="section level2">
<h2>Exercise 3. Translate written population description to projection matrix!</h2>
<p>As a test of your understanding, try to implement the following passage as a matrix projection model:</p>
<p><img src="redtail1.jpg" /></p>
<blockquote>
<p>We assumed that the red-tailed hawk life history could be described in terms of three major life stages: hatchling (first year of life), juvenile (largely individuals in their second year of life), and adult (generally the third year of life and beyond). We assumed that adults experienced an average of 20% mortality each year. Juvenile mortality was set at 25% per year. Approximately 10% of juveniles remain in the juvenile phase each year, and all other survivors transition to the adult stage. Finally, hatchlings had a 22% chance of surviving and transitioning to become juveniles. We initialized the population with 1000 hatchlings, 150 juveniles, and 5 adults. Adults are the primary reproductive stage, and produce an average of 3 new hatchlings each year. Juveniles that fail to transition to the Adult stage tend to produce only 1 new hatchling each year on average.</p>
</blockquote>
<p>3a. Provide your full transition matrix in Top Hat. Please also indicate your fecundity calculations (top row of the matrix) so we can give partial credit for incorrect answers! It can be difficult to do this as a standard text entry submission, so if you would rather upload an image (e.g., a photo of your hand-drawn matrix and calculations), you can use the optional image upload in Top Hat.</p>
<p>3b. How many hatchlings, juveniles and adults would there be in the population at time 0 if you were to initialize the population at S.A.D.? Use the same initial population size as the example above (1155 total individuals at time 0).</p>
<p>3c. What is the finite growth rate, Lambda, for this population?</p>
<p>##Checklist for Lab 4 completion</p>
<ul>
<li><p>Please submit all responses <em>using Top Hat</em>!</p></li>
<li><p>As always, URLs for your InsightMaker models should be pasted in your lab submission (in Top Hat). See details below…</p></li>
</ul>
<p><strong><em>Due Fri Mar. 4 at 11:59pm</em></strong></p>
<pre><code>+  **Exercise 1**
    -  *Short answer (1a.)*    
    -  *Short answer (1b.)*  
    -  *Short answer (1c.)* 
    -  *Short answer (1d.)* 
    -  *Short answer (1e.)* 

+  **Exercise 2**
    -  *Short answer (2a.)* 
    -  *IM and R plots (2b.)* 
    -  *InsightMaker url (2c.)* 
    -  *IM and R plots (2d.)*  

+  **Exercise 3**
    -  *Short answer (3a.)* 
    -  *Short answer (3b.)* 
    -  *Short answer (3c.)* 
    
    </code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
